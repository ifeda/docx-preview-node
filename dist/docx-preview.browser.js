var docx=function(e,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var a=r(t),s=Object.defineProperty,n=(e,t)=>s(e,"name",{value:t,configurable:!0});function l(e){return e?.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}function i(e){return/^[^"'].*\s.*[^"']$/.test(e)?`'${e}'`:e}function o(e){let t=e.lastIndexOf("/")+1;return[0==t?"":e.substring(0,t),0==t?e:e.substring(t)]}function c(e,t){try{const r="http://docx/";return new URL(e,r+t).toString().substring(r.length)}catch{return`${t}${e}`}}function h(e,t){return e.reduce((e,r)=>(e[t(r)]=r,e),{})}function m(e){return new Promise((t,r)=>{const a=new FileReader;a.onloadend=()=>t(a.result),a.onerror=()=>r(),a.readAsDataURL(e)})}function p(e){return e&&"object"==typeof e&&!Array.isArray(e)}function u(e){return"string"==typeof e||e instanceof String}function d(e,...t){if(!t.length)return e;const r=t.shift();if(p(e)&&p(r))for(const t in r)if(p(r[t])){d(e[t]??(e[t]={}),r[t])}else e[t]=r[t];return d(e,...t)}function f(e){return Array.isArray(e)?e:[e]}function g(e,t,r){return t>e?t:r<e?r:e}n(l,"escapeClassName"),n(i,"encloseFontFamily"),n(o,"splitPath"),n(c,"resolvePath"),n(h,"keyBy"),n(m,"blobToBase64"),n(p,"isObject"),n(u,"isString"),n(d,"mergeDeep"),n(f,"asArray"),n(g,"clamp");var b="http://schemas.openxmlformats.org/wordprocessingml/2006/main",y=window,k={mul:.05,unit:"pt"},v={mul:1/12700,unit:"pt"},S={mul:.5,unit:"pt"},P={mul:.125,unit:"pt",min:.25,max:12},w={mul:1,unit:"pt"},C={mul:.02,unit:"%"};function N(e,t=k){if(null==e||/.+(p[xt]|[%])$/.test(e))return e;var r=parseInt(e)*t.mul;return t.min&&t.max&&(r=g(r,t.min,t.max)),`${r.toFixed(2)}${t.unit}`}function x(e,t=!1){switch(e){case"1":case"on":case"true":return!0;case"0":case"off":case"false":return!1;default:return t}}function A(e,t,r){if(e.namespaceURI!=b)return!1;switch(e.localName){case"color":t.color=r.attr(e,"val");break;case"sz":t.fontSize=r.lengthAttr(e,"val",S);break;default:return!1}return!0}function E(e,t){return t.elements(e).map(e=>({id:t.attr(e,"Id"),type:t.attr(e,"Type"),target:t.attr(e,"Target"),targetMode:t.attr(e,"TargetMode")}))}function T(e,t=!1){t&&(e=e.replace(/<[?].*[?]>/,"")),e=B(e);const r=(new y.DOMParser).parseFromString(e,"application/xml"),a=R(r);if(a)throw new Error(a);return r}function R(e){return e.getElementsByTagName("parsererror")[0]?.textContent}function B(e){return 65279===e.charCodeAt(0)?e.substring(1):e}function D(e){return(new XMLSerializer).serializeToString(e)}n(N,"convertLength"),n(x,"convertBoolean"),n(A,"parseCommonProperty"),n(E,"parseRelationships"),n(T,"parseXmlString"),n(R,"hasXmlParserError"),n(B,"removeUTF8BOM"),n(D,"serializeXmlString");var M=class{static{n(this,"XmlParser")}elements(e,t=null){const r=[];for(let a=0,s=e.childNodes.length;a<s;a++){let s=e.childNodes.item(a);1!=s.nodeType||null!=t&&s.localName!=t||r.push(s)}return r}element(e,t){for(let r=0,a=e.childNodes.length;r<a;r++){let a=e.childNodes.item(r);if(1==a.nodeType&&a.localName==t)return a}return null}elementAttr(e,t,r){var a=this.element(e,t);return a?this.attr(a,r):void 0}attrs(e){return Array.from(e.attributes)}attr(e,t){for(let r=0,a=e.attributes.length;r<a;r++){let a=e.attributes.item(r);if(a.localName==t)return a.value}return null}intAttr(e,t,r=null){var a=this.attr(e,t);return a?parseInt(a):r}hexAttr(e,t,r=null){var a=this.attr(e,t);return a?parseInt(a,16):r}floatAttr(e,t,r=null){var a=this.attr(e,t);return a?parseFloat(a):r}boolAttr(e,t,r=null){return x(this.attr(e,t),r)}lengthAttr(e,t,r=k){return N(this.attr(e,t),r)}},$=new M,F=class{constructor(e,t){this._package=e,this.path=t}static{n(this,"Part")}async load(){this.rels=await this._package.loadRelationships(this.path);const e=await this._package.load(this.path),t=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=t),this.parseXml(t.firstElementChild)}save(){this._package.update(this.path,D(this._xmlDocument))}parseXml(e){}},L={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function O(e,t){return t.elements(e).map(e=>I(e,t))}function I(e,t){let r={name:t.attr(e,"name"),embedFontRefs:[]};for(let a of t.elements(e))switch(a.localName){case"family":r.family=t.attr(a,"val");break;case"altName":r.altName=t.attr(a,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":r.embedFontRefs.push(_(a,t))}return r}function _(e,t){return{id:t.attr(e,"id"),key:t.attr(e,"fontKey"),type:L[e.localName]}}n(O,"parseFonts"),n(I,"parseFont"),n(_,"parseEmbedFontRef");var H=class extends F{static{n(this,"FontTablePart")}parseXml(e){this.fonts=O(e,this._package.xmlParser)}},z=class e{constructor(e,t){this._zip=e,this.options=t,this.xmlParser=new M}static{n(this,"OpenXmlPackage")}get(e){const t=V(e);return this._zip.files[t]??this._zip.files[t.replace(/\//g,"\\")]}update(e,t){this._zip.file(e,t)}static async load(t,r){const s=await a.default.loadAsync(t);return new e(s,r)}save(e="blob"){return this._zip.generateAsync({type:e})}load(e,t="string"){return this.get(e)?.async(t)??Promise.resolve(null)}async loadRelationships(e=null){let t="_rels/.rels";if(null!=e){const[r,a]=o(e);t=`${r}_rels/${a}.rels`}const r=await this.load(t);return r?E(this.parseXmlDocument(r).firstElementChild,this.xmlParser):null}parseXmlDocument(e){return T(e,this.options.trimXmlDeclaration)}};function V(e){return e.startsWith("/")?e.substr(1):e}n(V,"normalizePath");var j=class extends F{static{n(this,"DocumentPart")}constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.body=this._documentParser.parseDocumentFile(e)}};function W(e,t){return{type:t.attr(e,"val"),color:t.attr(e,"color"),size:t.lengthAttr(e,"sz",P),offset:t.lengthAttr(e,"space",w),frame:t.boolAttr(e,"frame"),shadow:t.boolAttr(e,"shadow")}}function X(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"left":r.left=W(a,t);break;case"top":r.top=W(a,t);break;case"right":r.right=W(a,t);break;case"bottom":r.bottom=W(a,t)}return r}function G(e,t=$){var r={};for(let a of t.elements(e))switch(a.localName){case"pgSz":r.pageSize={width:t.lengthAttr(a,"w"),height:t.lengthAttr(a,"h"),orientation:t.attr(a,"orient")};break;case"type":r.type=t.attr(a,"val");break;case"pgMar":r.pageMargins={left:t.lengthAttr(a,"left"),right:t.lengthAttr(a,"right"),top:t.lengthAttr(a,"top"),bottom:t.lengthAttr(a,"bottom"),header:t.lengthAttr(a,"header"),footer:t.lengthAttr(a,"footer"),gutter:t.lengthAttr(a,"gutter")};break;case"cols":r.columns=U(a,t);break;case"headerReference":(r.headerRefs??(r.headerRefs=[])).push(J(a,t));break;case"footerReference":(r.footerRefs??(r.footerRefs=[])).push(J(a,t));break;case"titlePg":r.titlePage=t.boolAttr(a,"val",!0);break;case"pgBorders":r.pageBorders=X(a,t);break;case"pgNumType":r.pageNumber=q(a,t)}return r}function U(e,t){return{numberOfColumns:t.intAttr(e,"num"),space:t.lengthAttr(e,"space"),separator:t.boolAttr(e,"sep"),equalWidth:t.boolAttr(e,"equalWidth",!0),columns:t.elements(e,"col").map(e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")}))}}function q(e,t){return{chapSep:t.attr(e,"chapSep"),chapStyle:t.attr(e,"chapStyle"),format:t.attr(e,"fmt"),start:t.intAttr(e,"start")}}function J(e,t){return{id:t.attr(e,"id"),type:t.attr(e,"type")}}function Z(e,t){return{before:t.lengthAttr(e,"before"),after:t.lengthAttr(e,"after"),line:t.intAttr(e,"line"),lineRule:t.attr(e,"lineRule")}}function K(e,t){let r={};for(let a of t.elements(e))Y(a,r,t);return r}function Y(e,t,r){return!!A(e,t,r)}function Q(e,t){let r={};for(let a of t.elements(e))ee(a,r,t);return r}function ee(e,t,r){if(e.namespaceURI!=b)return!1;if(A(e,t,r))return!0;switch(e.localName){case"tabs":t.tabs=te(e,r);break;case"sectPr":t.sectionProps=G(e,r);break;case"numPr":t.numbering=re(e,r);break;case"spacing":return t.lineSpacing=Z(e,r),!1;case"textAlignment":return t.textAlignment=r.attr(e,"val"),!1;case"keepLines":t.keepLines=r.boolAttr(e,"val",!0);break;case"keepNext":t.keepNext=r.boolAttr(e,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=r.boolAttr(e,"val",!0);break;case"outlineLvl":t.outlineLevel=r.intAttr(e,"val");break;case"pStyle":t.styleName=r.attr(e,"val");break;case"rPr":t.runProps=K(e,r);break;default:return!1}return!0}function te(e,t){return t.elements(e,"tab").map(e=>({position:t.lengthAttr(e,"pos"),leader:t.attr(e,"leader"),style:t.attr(e,"val")}))}function re(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"numId":r.id=t.attr(a,"val");break;case"ilvl":r.level=t.intAttr(a,"val")}return r}function ae(e,t){let r={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let a of t.elements(e))switch(a.localName){case"num":r.numberings.push(se(a,t));break;case"abstractNum":r.abstractNumberings.push(ne(a,t));break;case"numPicBullet":r.bulletPictures.push(oe(a,t))}return r}function se(e,t){let r={id:t.attr(e,"numId"),overrides:[]};for(let a of t.elements(e))switch(a.localName){case"abstractNumId":r.abstractId=t.attr(a,"val");break;case"lvlOverride":r.overrides.push(ie(a,t))}return r}function ne(e,t){let r={id:t.attr(e,"abstractNumId"),levels:[]};for(let a of t.elements(e))switch(a.localName){case"name":r.name=t.attr(a,"val");break;case"multiLevelType":r.multiLevelType=t.attr(a,"val");break;case"numStyleLink":r.numberingStyleLink=t.attr(a,"val");break;case"styleLink":r.styleLink=t.attr(a,"val");break;case"lvl":r.levels.push(le(a,t))}return r}function le(e,t){let r={level:t.intAttr(e,"ilvl")};for(let a of t.elements(e))switch(a.localName){case"start":r.start=t.attr(a,"val");break;case"lvlRestart":r.restart=t.intAttr(a,"val");break;case"numFmt":r.format=t.attr(a,"val");break;case"lvlText":r.text=t.attr(a,"val");break;case"lvlJc":r.justification=t.attr(a,"val");break;case"lvlPicBulletId":r.bulletPictureId=t.attr(a,"val");break;case"pStyle":r.paragraphStyle=t.attr(a,"val");break;case"pPr":r.paragraphProps=Q(a,t);break;case"rPr":r.runProps=K(a,t)}return r}function ie(e,t){let r={level:t.intAttr(e,"ilvl")};for(let a of t.elements(e))switch(a.localName){case"startOverride":r.start=t.intAttr(a,"val");break;case"lvl":r.numberingLevel=le(a,t)}return r}function oe(e,t){var r=t.element(e,"pict"),a=r&&t.element(r,"shape"),s=a&&t.element(a,"imagedata");return s?{id:t.attr(e,"numPicBulletId"),referenceId:t.attr(s,"id"),style:t.attr(a,"style")}:null}n(W,"parseBorder"),n(X,"parseBorders"),n(G,"parseSectionProperties"),n(U,"parseColumns"),n(q,"parsePageNumber"),n(J,"parseFooterHeaderReference"),n(Z,"parseLineSpacing"),n(K,"parseRunProperties"),n(Y,"parseRunProperty"),n(Q,"parseParagraphProperties"),n(ee,"parseParagraphProperty"),n(te,"parseTabs"),n(re,"parseNumbering"),n(ae,"parseNumberingPart"),n(se,"parseNumbering"),n(ne,"parseAbstractNumbering"),n(le,"parseNumberingLevel"),n(ie,"parseNumberingLevelOverrride"),n(oe,"parseNumberingBulletPicture");var ce=class extends F{static{n(this,"NumberingPart")}constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){Object.assign(this,ae(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e)}},he=class extends F{static{n(this,"StylesPart")}constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.styles=this._documentParser.parseStylesFile(e)}},me=class{constructor(){this.children=[],this.cssStyle={}}static{n(this,"OpenXmlElementBase")}},pe=class extends me{constructor(){super(...arguments),this.type="header"}static{n(this,"WmlHeader")}},ue=class extends me{constructor(){super(...arguments),this.type="footer"}static{n(this,"WmlFooter")}},de=class extends F{static{n(this,"BaseHeaderFooterPart")}constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e)}},fe=class extends de{static{n(this,"HeaderPart")}createRootElement(){return new pe}},ge=class extends de{static{n(this,"FooterPart")}createRootElement(){return new ue}};function be(e,t){const r={};for(let a of t.elements(e))switch(a.localName){case"Template":r.template=a.textContent;break;case"Pages":r.pages=ye(a.textContent);break;case"Words":r.words=ye(a.textContent);break;case"Characters":r.characters=ye(a.textContent);break;case"Application":r.application=a.textContent;break;case"Lines":r.lines=ye(a.textContent);break;case"Paragraphs":r.paragraphs=ye(a.textContent);break;case"Company":r.company=a.textContent;break;case"AppVersion":r.appVersion=a.textContent}return r}function ye(e){if(void 0!==e)return parseInt(e)}n(be,"parseExtendedProps"),n(ye,"safeParseToInt");var ke=class extends F{static{n(this,"ExtendedPropsPart")}parseXml(e){this.props=be(e,this._package.xmlParser)}};function ve(e,t){const r={};for(let a of t.elements(e))switch(a.localName){case"title":r.title=a.textContent;break;case"description":r.description=a.textContent;break;case"subject":r.subject=a.textContent;break;case"creator":r.creator=a.textContent;break;case"keywords":r.keywords=a.textContent;break;case"language":r.language=a.textContent;break;case"lastModifiedBy":r.lastModifiedBy=a.textContent;break;case"revision":a.textContent&&(r.revision=parseInt(a.textContent))}return r}n(ve,"parseCoreProps");var Se=class extends F{static{n(this,"CorePropsPart")}parseXml(e){this.props=ve(e,this._package.xmlParser)}},Pe=class{static{n(this,"DmlTheme")}};function we(e,t){var r=new Pe,a=t.element(e,"themeElements");for(let e of t.elements(a))switch(e.localName){case"clrScheme":r.colorScheme=Ce(e,t);break;case"fontScheme":r.fontScheme=Ne(e,t)}return r}function Ce(e,t){var r={name:t.attr(e,"name"),colors:{}};for(let n of t.elements(e)){var a=t.element(n,"srgbClr"),s=t.element(n,"sysClr");a?r.colors[n.localName]=t.attr(a,"val"):s&&(r.colors[n.localName]=t.attr(s,"lastClr"))}return r}function Ne(e,t){var r={name:t.attr(e,"name")};for(let a of t.elements(e))switch(a.localName){case"majorFont":r.majorFont=xe(a,t);break;case"minorFont":r.minorFont=xe(a,t)}return r}function xe(e,t){return{latinTypeface:t.elementAttr(e,"latin","typeface"),eaTypeface:t.elementAttr(e,"ea","typeface"),csTypeface:t.elementAttr(e,"cs","typeface")}}n(we,"parseTheme"),n(Ce,"parseColorScheme"),n(Ne,"parseFontScheme"),n(xe,"parseFontInfo");var Ae=class extends F{static{n(this,"ThemePart")}constructor(e,t){super(e,t)}parseXml(e){this.theme=we(e,this._package.xmlParser)}},Ee=class{static{n(this,"WmlBaseNote")}},Te=class extends Ee{constructor(){super(...arguments),this.type="footnote"}static{n(this,"WmlFootnote")}},Re=class extends Ee{constructor(){super(...arguments),this.type="endnote"}static{n(this,"WmlEndnote")}},Be=class extends F{static{n(this,"BaseNotePart")}constructor(e,t,r){super(e,t),this._documentParser=r}},De=class extends Be{static{n(this,"FootnotesPart")}constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",Te)}},Me=class extends Be{static{n(this,"EndnotesPart")}constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",Re)}};function $e(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"defaultTabStop":r.defaultTabStop=t.lengthAttr(a,"val");break;case"footnotePr":r.footnoteProps=Fe(a,t);break;case"endnotePr":r.endnoteProps=Fe(a,t);break;case"autoHyphenation":r.autoHyphenation=t.boolAttr(a,"val")}return r}function Fe(e,t){var r={defaultNoteIds:[]};for(let a of t.elements(e))switch(a.localName){case"numFmt":r.nummeringFormat=t.attr(a,"val");break;case"footnote":case"endnote":r.defaultNoteIds.push(t.attr(a,"id"))}return r}n($e,"parseSettings"),n(Fe,"parseNoteProperties");var Le=class extends F{static{n(this,"SettingsPart")}constructor(e,t){super(e,t)}parseXml(e){this.settings=$e(e,this._package.xmlParser)}};function Oe(e,t){return t.elements(e,"property").map(e=>{const r=e.firstChild;return{formatId:t.attr(e,"fmtid"),name:t.attr(e,"name"),type:r.nodeName,value:r.textContent}})}n(Oe,"parseCustomProps");var Ie=class extends F{static{n(this,"CustomPropsPart")}parseXml(e){this.props=Oe(e,this._package.xmlParser)}},_e=class extends F{static{n(this,"CommentsPart")}constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.comments=this._documentParser.parseComments(e),this.commentMap=h(this.comments,e=>e.id)}},He=class extends F{constructor(e,t){super(e,t),this.comments=[]}static{n(this,"CommentsExtendedPart")}parseXml(e){const t=this._package.xmlParser;for(let r of t.elements(e,"commentEx"))this.comments.push({paraId:t.attr(r,"paraId"),paraIdParent:t.attr(r,"paraIdParent"),done:t.boolAttr(r,"done")});this.commentMap=h(this.comments,e=>e.paraId)}},ze=[{type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",target:"word/document.xml"},{type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",target:"docProps/app.xml"},{type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",target:"docProps/core.xml"},{type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",target:"docProps/custom.xml"}],Ve=class e{constructor(){this.parts=[],this.partsMap={}}static{n(this,"WordDocument")}static async load(t,r,a){var s=new e;return s._options=a,s._parser=r,s._package=await z.load(t,a),s.rels=await s._package.loadRelationships(),await Promise.all(ze.map(e=>{const t=s.rels.find(t=>t.type===e.type)??e;return s.loadRelationshipPart(t.target,t.type)})),s}save(e="blob"){return this._package.save(e)}async loadRelationshipPart(e,t){if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let r=null;switch(t){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument":this.documentPart=r=new j(this._package,e,this._parser);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable":this.fontTablePart=r=new H(this._package,e);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering":this.numberingPart=r=new ce(this._package,e,this._parser);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":this.stylesPart=r=new he(this._package,e,this._parser);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":this.themePart=r=new Ae(this._package,e);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes":this.footnotesPart=r=new De(this._package,e,this._parser);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes":this.endnotesPart=r=new Me(this._package,e,this._parser);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer":r=new ge(this._package,e,this._parser);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header":r=new fe(this._package,e,this._parser);break;case"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties":this.corePropsPart=r=new Se(this._package,e);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties":this.extendedPropsPart=r=new ke(this._package,e);break;case"http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties":r=new Ie(this._package,e);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings":this.settingsPart=r=new Le(this._package,e);break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments":this.commentsPart=r=new _e(this._package,e,this._parser);break;case"http://schemas.microsoft.com/office/2011/relationships/commentsExtended":this.commentsExtendedPart=r=new He(this._package,e)}if(null==r)return Promise.resolve(null);if(this.partsMap[e]=r,this.parts.push(r),await r.load(),r.rels?.length>0){const[e]=o(r.path);await Promise.all(r.rels.map(t=>this.loadRelationshipPart(c(t.target,e),t.type)))}return r}async loadDocumentImage(e,t){const r=await this.loadResource(t??this.documentPart,e,"blob");return this.blobToURL(r)}async loadNumberingImage(e){const t=await this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(t)}async loadFont(e,t){const r=await this.loadResource(this.fontTablePart,e,"uint8array");return r?this.blobToURL(new Blob([je(r,t)])):r}async loadAltChunk(e,t){return await this.loadResource(t??this.documentPart,e,"string")}blobToURL(e){return e?this._options.useBase64URL?m(e):URL.createObjectURL(e):null}findPartByRelId(e,t=null){var r=(t.rels??this.rels).find(t=>t.id==e);const a=t?o(t.path)[0]:"";return r?this.partsMap[c(r.target,a)]:null}getPathById(e,t){const r=e.rels.find(e=>e.id==t),[a]=o(e.path);return r?c(r.target,a):null}loadResource(e,t,r){const a=this.getPathById(e,t);return a?this._package.load(a,r):Promise.resolve(null)}};function je(e,t){const r=t.replace(/{|}|-/g,""),a=new Array(16);for(let e=0;e<16;e++)a[16-e-1]=parseInt(r.substr(2*e,2),16);for(let t=0;t<32;t++)e[t]=e[t]^a[t%16];return e}function We(e,t){return{type:"bookmarkStart",id:t.attr(e,"id"),name:t.attr(e,"name"),colFirst:t.intAttr(e,"colFirst"),colLast:t.intAttr(e,"colLast")}}function Xe(e,t){return{type:"bookmarkEnd",id:t.attr(e,"id")}}n(je,"deobfuscate"),n(We,"parseBookmarkStart"),n(Xe,"parseBookmarkEnd");var Ge=class extends me{constructor(){super(...arguments),this.type="vmlElement",this.attrs={}}static{n(this,"VmlElement")}};function Ue(e,t){var r=new Ge;switch(e.localName){case"rect":r.tagName="rect",Object.assign(r.attrs,{width:"100%",height:"100%"});break;case"oval":r.tagName="ellipse",Object.assign(r.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":r.tagName="line";break;case"shape":r.tagName="g";break;case"textbox":r.tagName="foreignObject",Object.assign(r.attrs,{width:"100%",height:"100%"});break;default:return null}for(const t of $.attrs(e))switch(t.localName){case"style":r.cssStyleText=t.value;break;case"fillcolor":r.attrs.fill=t.value;break;case"from":const[e,a]=Ze(t.value);Object.assign(r.attrs,{x1:e,y1:a});break;case"to":const[s,n]=Ze(t.value);Object.assign(r.attrs,{x2:s,y2:n})}for(const a of $.elements(e))switch(a.localName){case"stroke":Object.assign(r.attrs,qe(a));break;case"fill":Object.assign(r.attrs,Je());break;case"imagedata":r.tagName="image",Object.assign(r.attrs,{width:"100%",height:"100%"}),r.imageHref={id:$.attr(a,"id"),title:$.attr(a,"title")};break;case"txbxContent":r.children.push(...t.parseBodyElements(a));break;default:const e=Ue(a,t);e&&r.children.push(e)}return r}function qe(e){return{stroke:$.attr(e,"color"),"stroke-width":$.lengthAttr(e,"weight",v)??"1px"}}function Je(e){return{}}function Ze(e){return e.split(",")}n(Ue,"parseVmlElement"),n(qe,"parseStroke"),n(Je,"parseFill"),n(Ze,"parsePoint");var Ke=class extends me{constructor(){super(...arguments),this.type="comment"}static{n(this,"WmlComment")}},Ye=class extends me{constructor(e){super(),this.id=e,this.type="commentReference"}static{n(this,"WmlCommentReference")}},Qe=class extends me{constructor(e){super(),this.id=e,this.type="commentRangeStart"}static{n(this,"WmlCommentRangeStart")}},et=class extends me{constructor(e){super(),this.id=e,this.type="commentRangeEnd"}static{n(this,"WmlCommentRangeEnd")}},tt="inherit",rt="black",at="black",st="transparent",nt=[],lt={oMath:"mmlMath",oMathPara:"mmlMathParagraph",f:"mmlFraction",func:"mmlFunction",fName:"mmlFunctionName",num:"mmlNumerator",den:"mmlDenominator",rad:"mmlRadical",deg:"mmlDegree",e:"mmlBase",sSup:"mmlSuperscript",sSub:"mmlSubscript",sPre:"mmlPreSubSuper",sup:"mmlSuperArgument",sub:"mmlSubArgument",d:"mmlDelimiter",nary:"mmlNary",eqArr:"mmlEquationArray",lim:"mmlLimit",limLow:"mmlLimitLower",m:"mmlMatrix",mr:"mmlMatrixRow",box:"mmlBox",bar:"mmlBar",groupChr:"mmlGroupChar"},it=class{static{n(this,"DocumentParser")}constructor(e){this.options={ignoreWidth:!1,debug:!1,...e}}parseNotes(e,t,r){var a=[];for(let s of $.elements(e,t)){const e=new r;e.id=$.attr(s,"id"),e.noteType=$.attr(s,"type"),e.children=this.parseBodyElements(s),a.push(e)}return a}parseComments(e){var t=[];for(let r of $.elements(e,"comment")){const e=new Ke;e.id=$.attr(r,"id"),e.author=$.attr(r,"author"),e.initials=$.attr(r,"initials"),e.date=$.attr(r,"date"),e.children=this.parseBodyElements(r),t.push(e)}return t}parseDocumentFile(e){var t=$.element(e,"body"),r=$.element(e,"background"),a=$.element(t,"sectPr");return{type:"document",children:this.parseBodyElements(t),props:a?G(a,$):{},cssStyle:r?this.parseBackground(r):{}}}parseBackground(e){var t={},r=ct.colorAttr(e,"color");return r&&(t["background-color"]=r),t}parseBodyElements(e){var t=[];for(let r of $.elements(e))switch(r.localName){case"p":t.push(this.parseParagraph(r));break;case"altChunk":t.push(this.parseAltChunk(r));break;case"tbl":t.push(this.parseTable(r));break;case"sdt":t.push(...this.parseSdt(r,e=>this.parseBodyElements(e)))}return t}parseStylesFile(e){var t=[];return ct.foreach(e,e=>{switch(e.localName){case"style":t.push(this.parseStyle(e));break;case"docDefaults":t.push(this.parseDefaultStyles(e))}}),t}parseDefaultStyles(e){var t={id:null,name:null,target:null,basedOn:null,styles:[]};return ct.foreach(e,e=>{switch(e.localName){case"rPrDefault":var r=$.element(e,"rPr");r&&t.styles.push({target:"span",values:this.parseDefaultProperties(r,{})});break;case"pPrDefault":var a=$.element(e,"pPr");a&&t.styles.push({target:"p",values:this.parseDefaultProperties(a,{})})}}),t}parseStyle(e){var t={id:$.attr(e,"styleId"),isDefault:$.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch($.attr(e,"type")){case"paragraph":t.target="p";break;case"table":t.target="table";break;case"character":t.target="span"}return ct.foreach(e,e=>{switch(e.localName){case"basedOn":t.basedOn=$.attr(e,"val");break;case"name":t.name=$.attr(e,"val");break;case"link":t.linked=$.attr(e,"val");break;case"next":t.next=$.attr(e,"val");break;case"aliases":t.aliases=$.attr(e,"val").split(",");break;case"pPr":t.styles.push({target:"p",values:this.parseDefaultProperties(e,{})}),t.paragraphProps=Q(e,$);break;case"rPr":t.styles.push({target:"span",values:this.parseDefaultProperties(e,{})}),t.runProps=K(e,$);break;case"tblPr":case"tcPr":t.styles.push({target:"td",values:this.parseDefaultProperties(e,{})});break;case"tblStylePr":for(let r of this.parseTableStyle(e))t.styles.push(r);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${e.localName}`)}}),t}parseTableStyle(e){var t=[],r=$.attr(e,"type"),a="",s="";switch(r){case"firstRow":s=".first-row",a="tr.first-row td";break;case"lastRow":s=".last-row",a="tr.last-row td";break;case"firstCol":s=".first-col",a="td.first-col";break;case"lastCol":s=".last-col",a="td.last-col";break;case"band1Vert":s=":not(.no-vband)",a="td.odd-col";break;case"band2Vert":s=":not(.no-vband)",a="td.even-col";break;case"band1Horz":s=":not(.no-hband)",a="tr.odd-row";break;case"band2Horz":s=":not(.no-hband)",a="tr.even-row";break;default:return[]}return ct.foreach(e,e=>{switch(e.localName){case"pPr":t.push({target:`${a} p`,mod:s,values:this.parseDefaultProperties(e,{})});break;case"rPr":t.push({target:`${a} span`,mod:s,values:this.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":t.push({target:a,mod:s,values:this.parseDefaultProperties(e,{})})}}),t}parseNumberingFile(e){var t=[],r={},a=[];return ct.foreach(e,e=>{switch(e.localName){case"abstractNum":this.parseAbstractNumbering(e,a).forEach(e=>t.push(e));break;case"numPicBullet":a.push(this.parseNumberingPicBullet(e));break;case"num":var s=$.attr(e,"numId"),n=$.elementAttr(e,"abstractNumId","val");r[n]=s}}),t.forEach(e=>e.id=r[e.id]),t}parseNumberingPicBullet(e){var t=$.element(e,"pict"),r=t&&$.element(t,"shape"),a=r&&$.element(r,"imagedata");return a?{id:$.intAttr(e,"numPicBulletId"),src:$.attr(a,"id"),style:$.attr(r,"style")}:null}parseAbstractNumbering(e,t){var r=[],a=$.attr(e,"abstractNumId");return ct.foreach(e,e=>{if("lvl"===e.localName)r.push(this.parseNumberingLevel(a,e,t))}),r}parseNumberingLevel(e,t,r){var a={id:e,level:$.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return ct.foreach(t,e=>{switch(e.localName){case"start":a.start=$.intAttr(e,"val");break;case"pPr":this.parseDefaultProperties(e,a.pStyle);break;case"rPr":this.parseDefaultProperties(e,a.rStyle);break;case"lvlPicBulletId":var t=$.intAttr(e,"val");a.bullet=r.find(e=>e?.id==t);break;case"lvlText":a.levelText=$.attr(e,"val");break;case"pStyle":a.pStyleName=$.attr(e,"val");break;case"numFmt":a.format=$.attr(e,"val");break;case"suff":a.suff=$.attr(e,"val")}}),a}parseSdt(e,t){const r=$.element(e,"sdtContent");return r?t(r):[]}parseInserted(e,t){return{type:"inserted",children:t(e)?.children??[]}}parseDeleted(e,t){return{type:"deleted",children:t(e)?.children??[]}}parseAltChunk(e){return{type:"altChunk",children:[],id:$.attr(e,"id")}}parseParagraph(e){var t={type:"paragraph",children:[]};for(let r of $.elements(e))switch(r.localName){case"pPr":this.parseParagraphProperties(r,t);break;case"r":t.children.push(this.parseRun(r,t));break;case"hyperlink":t.children.push(this.parseHyperlink(r,t));break;case"smartTag":t.children.push(this.parseSmartTag(r,t));break;case"bookmarkStart":t.children.push(We(r,$));break;case"bookmarkEnd":t.children.push(Xe(r,$));break;case"commentRangeStart":t.children.push(new Qe($.attr(r,"id")));break;case"commentRangeEnd":t.children.push(new et($.attr(r,"id")));break;case"oMath":case"oMathPara":t.children.push(this.parseMathElement(r));break;case"sdt":t.children.push(...this.parseSdt(r,e=>this.parseParagraph(e).children));break;case"ins":t.children.push(this.parseInserted(r,e=>this.parseParagraph(e)));break;case"del":t.children.push(this.parseDeleted(r,e=>this.parseParagraph(e)))}return t}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{if(ee(e,t,$))return!0;switch(e.localName){case"pStyle":t.styleName=$.attr(e,"val");break;case"cnfStyle":t.className=ht.classNameOfCnfStyle(e);break;case"framePr":this.parseFrame(e,t);break;case"rPr":break;default:return!1}return!0})}parseFrame(e,t){"drop"==$.attr(e,"dropCap")&&(t.cssStyle.float="left")}parseHyperlink(e,t){var r={type:"hyperlink",parent:t,children:[]};return r.anchor=$.attr(e,"anchor"),r.id=$.attr(e,"id"),ct.foreach(e,e=>{if("r"===e.localName)r.children.push(this.parseRun(e,r))}),r}parseSmartTag(e,t){var r={type:"smartTag",parent:t,children:[]},a=$.attr(e,"uri"),s=$.attr(e,"element");return a&&(r.uri=a),s&&(r.element=s),ct.foreach(e,e=>{if("r"===e.localName)r.children.push(this.parseRun(e,r))}),r}parseRun(e,t){var r={type:"run",parent:t,children:[]};return ct.foreach(e,e=>{switch((e=this.checkAlternateContent(e)).localName){case"t":r.children.push({type:"text",text:e.textContent});break;case"delText":r.children.push({type:"deletedText",text:e.textContent});break;case"commentReference":r.children.push(new Ye($.attr(e,"id")));break;case"fldSimple":r.children.push({type:"simpleField",instruction:$.attr(e,"instr"),lock:$.boolAttr(e,"lock",!1),dirty:$.boolAttr(e,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:"instruction",text:e.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:"complexField",charType:$.attr(e,"fldCharType"),lock:$.boolAttr(e,"lock",!1),dirty:$.boolAttr(e,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:"noBreakHyphen"});break;case"br":r.children.push({type:"break",break:$.attr(e,"type")||"textWrapping"});break;case"lastRenderedPageBreak":r.children.push({type:"break",break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:"symbol",font:i($.attr(e,"font")),char:$.attr(e,"char")});break;case"tab":r.children.push({type:"tab"});break;case"footnoteReference":r.children.push({type:"footnoteReference",id:$.attr(e,"id")});break;case"endnoteReference":r.children.push({type:"endnoteReference",id:$.attr(e,"id")});break;case"drawing":let t=this.parseDrawing(e);t&&(r.children=[t]);break;case"pict":r.children.push(this.parseVmlPicture(e));break;case"rPr":this.parseRunProperties(e,r)}}),r}parseMathElement(e){const t=`${e.localName}Pr`,r={type:lt[e.localName],children:[]};for(const s of $.elements(e)){if(lt[s.localName])r.children.push(this.parseMathElement(s));else if("r"==s.localName){var a=this.parseRun(s);a.type="mmlRun",r.children.push(a)}else s.localName==t&&(r.props=this.parseMathProperies(s))}return r}parseMathProperies(e){const t={};for(const r of $.elements(e))switch(r.localName){case"chr":t.char=$.attr(r,"val");break;case"vertJc":t.verticalJustification=$.attr(r,"val");break;case"pos":t.position=$.attr(r,"val");break;case"degHide":t.hideDegree=$.boolAttr(r,"val");break;case"begChr":t.beginChar=$.attr(r,"val");break;case"endChr":t.endChar=$.attr(r,"val")}return t}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{switch(e.localName){case"rStyle":t.styleName=$.attr(e,"val");break;case"vertAlign":t.verticalAlign=ht.valueOfVertAlign(e,!0);break;default:return!1}return!0})}parseVmlPicture(e){const t={type:"vmlPicture",children:[]};for(const r of $.elements(e)){const e=Ue(r,this);e&&t.children.push(e)}return t}checkAlternateContent(e){if("AlternateContent"!=e.localName)return e;var t=$.element(e,"Choice");if(t){var r=$.attr(t,"Requires"),a=e.lookupNamespaceURI(r);if(nt.includes(a))return t.firstElementChild}return $.element(e,"Fallback")?.firstElementChild}parseDrawing(e){for(var t of $.elements(e))switch(t.localName){case"inline":case"anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){var t={type:"drawing",children:[],cssStyle:{}},r="anchor"==e.localName;let a=null,s=$.boolAttr(e,"simplePos");$.boolAttr(e,"behindDoc");let n={relative:"page",align:"left",offset:"0"},l={relative:"page",align:"top",offset:"0"};for(var i of $.elements(e))switch(i.localName){case"simplePos":s&&(n.offset=$.lengthAttr(i,"x",v),l.offset=$.lengthAttr(i,"y",v));break;case"extent":t.cssStyle.width=$.lengthAttr(i,"cx",v),t.cssStyle.height=$.lengthAttr(i,"cy",v);break;case"positionH":case"positionV":if(!s){let e="positionH"==i.localName?n:l;var o=$.element(i,"align"),c=$.element(i,"posOffset");e.relative=$.attr(i,"relativeFrom")??e.relative,o&&(e.align=o.textContent),c&&(e.offset=ct.sizeValue(c,v))}break;case"wrapTopAndBottom":a="wrapTopAndBottom";break;case"wrapNone":a="wrapNone";break;case"graphic":var h=this.parseGraphic(i);h&&t.children.push(h)}return"wrapTopAndBottom"==a?(t.cssStyle.display="block",n.align&&(t.cssStyle["text-align"]=n.align,t.cssStyle.width="100%")):"wrapNone"==a?(t.cssStyle.display="block",t.cssStyle.position="relative",t.cssStyle.width="0px",t.cssStyle.height="0px",n.offset&&(t.cssStyle.left=n.offset),l.offset&&(t.cssStyle.top=l.offset)):!r||"left"!=n.align&&"right"!=n.align||(t.cssStyle.float=n.align),t}parseGraphic(e){var t=$.element(e,"graphicData");for(let e of $.elements(t))if("pic"===e.localName)return this.parsePicture(e);return null}parsePicture(e){var t={type:"image",src:"",cssStyle:{}},r=$.element(e,"blipFill"),a=$.element(r,"blip");t.src=$.attr(a,"embed");var s=$.element(e,"spPr"),n=$.element(s,"xfrm");for(var l of(t.cssStyle.position="relative",$.elements(n)))switch(l.localName){case"ext":t.cssStyle.width=$.lengthAttr(l,"cx",v),t.cssStyle.height=$.lengthAttr(l,"cy",v);break;case"off":t.cssStyle.left=$.lengthAttr(l,"x",v),t.cssStyle.top=$.lengthAttr(l,"y",v)}return t}parseTable(e){var t={type:"table",children:[]};return ct.foreach(e,e=>{switch(e.localName){case"tr":t.children.push(this.parseTableRow(e));break;case"tblGrid":t.columns=this.parseTableColumns(e);break;case"tblPr":this.parseTableProperties(e,t)}}),t}parseTableColumns(e){var t=[];return ct.foreach(e,e=>{if("gridCol"===e.localName)t.push({width:$.lengthAttr(e,"w")})}),t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,e=>{switch(e.localName){case"tblStyle":t.styleName=$.attr(e,"val");break;case"tblLook":t.className=ht.classNameOftblLook(e);break;case"tblpPr":this.parseTablePosition(e,t);break;case"tblStyleColBandSize":t.colBandSize=$.intAttr(e,"val");break;case"tblStyleRowBandSize":t.rowBandSize=$.intAttr(e,"val");break;case"hidden":t.cssStyle.display="none";break;default:return!1}return!0}),t.cssStyle["text-align"]){case"center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case"right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto"}}parseTablePosition(e,t){var r=$.lengthAttr(e,"topFromText"),a=$.lengthAttr(e,"bottomFromText"),s=$.lengthAttr(e,"rightFromText"),n=$.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=ht.addSize(t.cssStyle["margin-bottom"],a),t.cssStyle["margin-left"]=ht.addSize(t.cssStyle["margin-left"],n),t.cssStyle["margin-right"]=ht.addSize(t.cssStyle["margin-right"],s),t.cssStyle["margin-top"]=ht.addSize(t.cssStyle["margin-top"],r)}parseTableRow(e){var t={type:"row",children:[]};return ct.foreach(e,e=>{switch(e.localName){case"tc":t.children.push(this.parseTableCell(e));break;case"trPr":this.parseTableRowProperties(e,t)}}),t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"cnfStyle":t.className=ht.classNameOfCnfStyle(e);break;case"tblHeader":t.isHeader=$.boolAttr(e,"val");break;case"gridBefore":t.gridBefore=$.intAttr(e,"val");break;case"gridAfter":t.gridAfter=$.intAttr(e,"val");break;default:return!1}return!0})}parseTableCell(e){var t={type:"cell",children:[]};return ct.foreach(e,e=>{switch(e.localName){case"tbl":t.children.push(this.parseTable(e));break;case"p":t.children.push(this.parseParagraph(e));break;case"tcPr":this.parseTableCellProperties(e,t)}}),t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"gridSpan":t.span=$.intAttr(e,"val",null);break;case"vMerge":t.verticalMerge=$.attr(e,"val")??"continue";break;case"cnfStyle":t.className=ht.classNameOfCnfStyle(e);break;default:return!1}return!0}),this.parseTableCellVerticalText(e,t)}parseTableCellVerticalText(e,t){const r={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};ct.foreach(e,e=>{if("textDirection"===e.localName){const a=$.attr(e,"val"),s=r[a]||{writingMode:"horizontal-tb"};t.cssStyle["writing-mode"]=s.writingMode,t.cssStyle.transform=s.transform}})}parseDefaultProperties(e,t=null,r=null,a=null){return t=t||{},ct.foreach(e,s=>{if(!a?.(s))switch(s.localName){case"jc":t["text-align"]=ht.valueOfJc(s);break;case"textAlignment":t["vertical-align"]=ht.valueOfTextAlignment(s);break;case"color":t.color=ct.colorAttr(s,"val",null,rt);break;case"sz":t["font-size"]=t["min-height"]=$.lengthAttr(s,"val",S);break;case"shd":t["background-color"]=ct.colorAttr(s,"fill",null,tt);break;case"highlight":t["background-color"]=ct.colorAttr(s,"val",null,st);break;case"vertAlign":break;case"position":t.verticalAlign=$.lengthAttr(s,"val",S);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":t.width=ht.valueOfSize(s,"w");break;case"trHeight":this.parseTrHeight(s,t);break;case"strike":t["text-decoration"]=$.boolAttr(s,"val",!0)?"line-through":"none";break;case"b":t["font-weight"]=$.boolAttr(s,"val",!0)?"bold":"normal";break;case"i":t["font-style"]=$.boolAttr(s,"val",!0)?"italic":"normal";break;case"caps":t["text-transform"]=$.boolAttr(s,"val",!0)?"uppercase":"none";break;case"smallCaps":t["font-variant"]=$.boolAttr(s,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(s,t);break;case"ind":case"tblInd":this.parseIndentation(s,t);break;case"rFonts":this.parseFont(s,t);break;case"tblBorders":this.parseBorderProperties(s,r||t);break;case"tblCellSpacing":t["border-spacing"]=ht.valueOfMargin(s),t["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(s,t);break;case"bdr":t.border=ht.valueOfBorder(s);break;case"tcBorders":this.parseBorderProperties(s,t);break;case"vanish":$.boolAttr(s,"val",!0)&&(t.display="none");break;case"kern":case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(s,r||t);break;case"tblLayout":t["table-layout"]=ht.valueOfTblLayout(s);break;case"vAlign":t["vertical-align"]=ht.valueOfTextAlignment(s);break;case"spacing":"pPr"==e.localName&&this.parseSpacing(s,t);break;case"wordWrap":$.boolAttr(s,"val")&&(t["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":t.hyphens=$.boolAttr(s,"val",!0)?"none":"auto";break;case"lang":t.$lang=$.attr(s,"val");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${e.localName}.${s.localName}`)}}),t}parseUnderline(e,t){var r=$.attr(e,"val");if(null!=r){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":t["text-decoration"]="underline dotted";break;case"double":t["text-decoration"]="underline double";break;case"single":case"thick":case"words":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration"]="underline wavy";break;case"none":t["text-decoration"]="none"}var a=ct.colorAttr(e,"color");a&&(t["text-decoration-color"]=a)}}parseFont(e,t){var r=[$.attr(e,"ascii"),ht.themeValue(e,"asciiTheme"),$.attr(e,"eastAsia")].filter(e=>e).map(e=>i(e));r.length>0&&(t["font-family"]=[...new Set(r)].join(", "))}parseIndentation(e,t){var r=$.lengthAttr(e,"firstLine"),a=$.lengthAttr(e,"hanging"),s=$.lengthAttr(e,"left"),n=$.lengthAttr(e,"start"),l=$.lengthAttr(e,"right"),i=$.lengthAttr(e,"end");r&&(t["text-indent"]=r),a&&(t["text-indent"]=`-${a}`),(s||n)&&(t["margin-left"]=s||n),(l||i)&&(t["margin-right"]=l||i)}parseSpacing(e,t){var r=$.lengthAttr(e,"before"),a=$.lengthAttr(e,"after"),s=$.intAttr(e,"line",null),n=$.attr(e,"lineRule");if(r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),null!==s)switch(n){case"auto":t["line-height"]=`${(s/240).toFixed(2)}`;break;case"atLeast":t["line-height"]=`calc(100% + ${s/20}pt)`;break;default:t["line-height"]=t["min-height"]=s/20+"pt"}}parseMarginProperties(e,t){ct.foreach(e,e=>{switch(e.localName){case"left":t["padding-left"]=ht.valueOfMargin(e);break;case"right":t["padding-right"]=ht.valueOfMargin(e);break;case"top":t["padding-top"]=ht.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=ht.valueOfMargin(e)}})}parseTrHeight(e,t){$.attr(e,"hRule"),t.height=$.lengthAttr(e,"val")}parseBorderProperties(e,t){ct.foreach(e,e=>{switch(e.localName){case"start":case"left":t["border-left"]=ht.valueOfBorder(e);break;case"end":case"right":t["border-right"]=ht.valueOfBorder(e);break;case"top":t["border-top"]=ht.valueOfBorder(e);break;case"bottom":t["border-bottom"]=ht.valueOfBorder(e)}})}},ot=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"],ct=class{static{n(this,"xmlUtil")}static foreach(e,t){for(var r=0;r<e.childNodes.length;r++){let a=e.childNodes[r];a.nodeType==y.Node.ELEMENT_NODE&&t(a)}}static colorAttr(e,t,r=null,a="black"){var s=$.attr(e,t);if(s)return"auto"==s?a:ot.includes(s)?s:`#${s}`;var n=$.attr(e,"themeColor");return n?`var(--docx-${n}-color)`:r}static sizeValue(e,t=k){return N(e.textContent,t)}},ht=class e{static{n(this,"values")}static themeValue(e,t){var r=$.attr(e,t);return r?`var(--docx-${r}-font)`:null}static valueOfSize(e,t){var r=k;switch($.attr(e,"type")){case"dxa":break;case"pct":r=C;break;case"auto":return"auto"}return $.lengthAttr(e,t,r)}static valueOfMargin(e){return $.lengthAttr(e,"w")}static valueOfBorder(t){var r=e.parseBorderType($.attr(t,"val"));if("none"==r)return"none";var a=ct.colorAttr(t,"color");return`${$.lengthAttr(t,"sz",P)} ${r} ${"auto"==a?at:a}`}static parseBorderType(e){switch(e){case"single":case"dashDotStroked":case"thick":case"thickThinLargeGap":case"thickThinMediumGap":case"thickThinSmallGap":case"thinThickLargeGap":case"thinThickMediumGap":case"thinThickSmallGap":case"thinThickThinLargeGap":case"thinThickThinMediumGap":case"thinThickThinSmallGap":case"threeDEmboss":case"threeDEngrave":case"wave":return"solid";case"dashed":case"dashSmallGap":return"dashed";case"dotDash":case"dotDotDash":case"dotted":return"dotted";case"double":case"doubleWave":case"triple":return"double";case"inset":return"inset";case"nil":case"none":return"none";case"outset":return"outset"}return"solid"}static valueOfTblLayout(e){return"fixed"==$.attr(e,"val")?"fixed":"auto"}static classNameOfCnfStyle(e){const t=$.attr(e,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((e,r)=>"1"==t[r]).join(" ")}static valueOfJc(e){var t=$.attr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t}static valueOfVertAlign(e,t=!1){var r=$.attr(e,"val");switch(r){case"subscript":return"sub";case"superscript":return t?"sup":"super"}return t?null:r}static valueOfTextAlignment(e){var t=$.attr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t}static addSize(e,t){return null==e?t:null==t?e:`calc(${e} + ${t})`}static classNameOftblLook(e){const t=$.hexAttr(e,"val",0);let r="";return($.boolAttr(e,"firstRow")||32&t)&&(r+=" first-row"),($.boolAttr(e,"lastRow")||64&t)&&(r+=" last-row"),($.boolAttr(e,"firstColumn")||128&t)&&(r+=" first-col"),($.boolAttr(e,"lastColumn")||256&t)&&(r+=" last-col"),($.boolAttr(e,"noHBand")||512&t)&&(r+=" no-hband"),($.boolAttr(e,"noVBand")||1024&t)&&(r+=" no-vband"),r.trim()}},mt={pos:0,leader:"none",style:"left"};function pt(e=y.document.body){const t=document.createElement("div");t.style.width="100pt",e.appendChild(t);const r=100/t.offsetWidth;return e.removeChild(t),r}function ut(e,t,r,a=.75){const s=e.closest("p"),n=e.getBoundingClientRect(),l=s.getBoundingClientRect(),i=getComputedStyle(s),o=t?.length>0?t.map(e=>({pos:dt(e.position),leader:e.leader,style:e.style})).sort((e,t)=>e.pos-t.pos):[mt],c=o[o.length-1],h=l.width*a,m=dt(r);let p=c.pos+m;if(p<h)for(;p<h&&o.length<50;p+=m)o.push({...mt,pos:p});const u=parseFloat(i.marginLeft),d=l.left+u,f=(n.left-d)*a,g=o.find(e=>"clear"!=e.style&&e.pos>f);if(null==g)return;let b=1;if("right"==g.style||"center"==g.style){const t=Array.from(s.querySelectorAll(`.${e.className}`)),r=t.indexOf(e)+1,n=document.createRange();n.setStart(e,1),r<t.length?n.setEndBefore(t[r]):n.setEndAfter(s);const i="center"==g.style?.5:1,o=n.getBoundingClientRect(),c=o.left+i*o.width-(l.left-u);b=g.pos-c*a}else b=g.pos-f;switch(e.innerHTML="&nbsp;",e.style.textDecoration="inherit",e.style.wordSpacing=`${b.toFixed(0)}pt`,g.leader){case"dot":case"middleDot":e.style.textDecoration="underline",e.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":e.style.textDecoration="underline"}}function dt(e){return parseFloat(e)}n(pt,"computePixelToPoint"),n(ut,"updateTabStop"),n(dt,"lengthToPoint");var ft="http://www.w3.org/2000/svg",gt="http://www.w3.org/1998/Math/MathML",bt=class{constructor(e){this.htmlDocument=e,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.commentMap={},this.tasks=[],this.postRenderTasks=[]}static{n(this,"HtmlRenderer")}async render(e,t,r=null,a){this.document=e,this.options=a,this.className=a.className,this.rootSelector=a.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],this.options.renderComments&&globalThis.Highlight&&(this.commentHighlight=new Highlight),yt(r=r||t),yt(t),r.appendChild(this.createComment("docxjs library predefined styles")),r.appendChild(this.renderDefaultStyle()),e.themePart&&(r.appendChild(this.createComment("docxjs document theme values")),this.renderTheme(e.themePart,r)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),r.appendChild(this.createComment("docxjs document styles")),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.prodessNumberings(e.numberingPart.domNumberings),r.appendChild(this.createComment("docxjs document numbering styles")),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),e.footnotesPart&&(this.footnoteMap=h(e.footnotesPart.notes,e=>e.id)),e.endnotesPart&&(this.endnoteMap=h(e.endnotesPart.notes,e=>e.id)),e.settingsPart&&(this.defaultTabSize=e.settingsPart.settings?.defaultTabStop),!a.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r);var s=this.renderSections(e.documentPart.body);this.options.inWrapper?t.appendChild(this.renderWrapper(s)):kt(t,s),this.commentHighlight&&a.renderComments&&CSS.highlights.set(`${this.className}-comments`,this.commentHighlight),this.postRenderTasks.forEach(e=>e()),await Promise.allSettled(this.tasks),this.refreshTabStops()}renderTheme(e,t){const r={},a=e.theme?.fontScheme;a&&(a.majorFont&&(r["--docx-majorHAnsi-font"]=a.majorFont.latinTypeface),a.minorFont&&(r["--docx-minorHAnsi-font"]=a.minorFont.latinTypeface));const s=e.theme?.colorScheme;if(s)for(let[e,t]of Object.entries(s.colors))r[`--docx-${e}-color`]=`#${t}`;const n=this.styleToString(`.${this.className}`,r);t.appendChild(this.createStyleElement(n))}renderFontTable(e,t){for(let r of e.fonts)for(let e of r.embedFontRefs)this.tasks.push(this.document.loadFont(e.id,e.key).then(a=>{const s={"font-family":i(r.name),src:`url(${a})`};"bold"!=e.type&&"boldItalic"!=e.type||(s["font-weight"]="bold"),"italic"!=e.type&&"boldItalic"!=e.type||(s["font-style"]="italic");const n=this.styleToString("@font-face",s);t.appendChild(this.createComment(`docxjs ${r.name} font`)),t.appendChild(this.createStyleElement(n))}))}processStyleName(e){return e?`${this.className}_${l(e)}`:this.className}processStyles(e){const t=h(e.filter(e=>null!=e.id),e=>e.id);for(const a of e.filter(e=>e.basedOn)){var r=t[a.basedOn];if(r){a.paragraphProps=d(a.paragraphProps,r.paragraphProps),a.runProps=d(a.runProps,r.runProps);for(const e of r.styles){const t=a.styles.find(t=>t.target==e.target);t?this.copyStyleProperties(e.values,t.values):a.styles.push({...e,values:{...e.values}})}}else this.options.debug&&console.warn(`Can't find base style ${a.basedOn}`)}for(let t of e)t.cssName=this.processStyleName(t.id);return t}prodessNumberings(e){for(let t of e.filter(e=>e.pStyleName)){const e=this.findStyle(t.pStyleName);e?.paragraphProps?.numbering&&(e.paragraphProps.numbering.level=t.level)}}processElement(e){if(e.children)for(var t of e.children)t.parent=e,"table"==t.type?this.processTable(t):this.processElement(t)}processTable(e){for(var t of e.children)for(var r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}copyStyleProperties(e,t,r=null){if(!e)return t;for(var a of(null==t&&(t={}),null==r&&(r=Object.getOwnPropertyNames(e)),r))e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a]);return t}createPageElement(e,t){var r=this.createElement("section",{className:e});return t&&(t.pageMargins&&(r.style.paddingLeft=t.pageMargins.left,r.style.paddingRight=t.pageMargins.right,r.style.paddingTop=t.pageMargins.top,r.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(r.style.width=t.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=t.pageSize.height))),r}createSectionContent(e){var t=this.createElement("article");return e.columns&&e.columns.numberOfColumns&&(t.style.columnCount=`${e.columns.numberOfColumns}`,t.style.columnGap=e.columns.space,e.columns.separator&&(t.style.columnRule="1px solid black")),t}renderSections(e){const t=[];this.processElement(e);const r=this.splitBySection(e.children,e.props),a=this.groupByPageBreaks(r);let s=null;for(let r=0,l=a.length;r<l;r++){this.currentFootnoteIds=[];let i=a[r][0].sectProps;const o=this.createPageElement(this.className,i);this.renderStyleValues(e.cssStyle,o),this.options.renderHeaders&&this.renderHeaderFooter(i.headerRefs,i,t.length,s!=i,o);for(const e of a[r]){var n=this.createSectionContent(e.sectProps);this.renderElements(e.elements,n),o.appendChild(n),i=e.sectProps}this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,o),this.options.renderEndnotes&&r==l-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,o),this.options.renderFooters&&this.renderHeaderFooter(i.footerRefs,i,t.length,s!=i,o),t.push(o),s=i}return t}renderHeaderFooter(e,t,r,a,s){if(e){var n=(t.titlePage&&a?e.find(e=>"first"==e.type):null)??(r%2==1?e.find(e=>"even"==e.type):null)??e.find(e=>"default"==e.type),l=n&&this.document.findPartByRelId(n.id,this.document.documentPart);if(l){this.currentPart=l,this.usedHederFooterParts.includes(l.path)||(this.processElement(l.rootElement),this.usedHederFooterParts.push(l.path));const[e]=this.renderElements([l.rootElement],s);t?.pageMargins&&("header"===l.rootElement.type?(e.style.marginTop=`calc(${t.pageMargins.header} - ${t.pageMargins.top})`,e.style.minHeight=`calc(${t.pageMargins.top} - ${t.pageMargins.header})`):"footer"===l.rootElement.type&&(e.style.marginBottom=`calc(${t.pageMargins.footer} - ${t.pageMargins.bottom})`,e.style.minHeight=`calc(${t.pageMargins.bottom} - ${t.pageMargins.footer})`)),this.currentPart=null}}}isPageBreakElement(e){return"break"==e.type&&("lastRenderedPageBreak"==e.break?!this.options.ignoreLastRenderedPageBreak:"page"==e.break)}isPageBreakSection(e,t){return!!e&&(!!t&&(e.pageSize?.orientation!=t.pageSize?.orientation||e.pageSize?.width!=t.pageSize?.width||e.pageSize?.height!=t.pageSize?.height))}splitBySection(e,t){var r={sectProps:null,elements:[],pageBreak:!1},a=[r];for(let t of e){if("paragraph"==t.type){const e=this.findStyle(t.styleName);e?.paragraphProps?.pageBreakBefore&&(r.sectProps=s,r.pageBreak=!0,r={sectProps:null,elements:[],pageBreak:!1},a.push(r))}if(r.elements.push(t),"paragraph"==t.type){const e=t;var s=e.sectionProps,n=-1,l=-1;if(this.options.breakPages&&e.children&&(n=e.children.findIndex(e=>-1!=(l=e.children?.findIndex(this.isPageBreakElement.bind(this))??-1))),(s||-1!=n)&&(r.sectProps=s,r.pageBreak=-1!=n,r={sectProps:null,elements:[],pageBreak:!1},a.push(r)),-1!=n){let a=e.children[n],s=l<a.children.length-1;if(n<e.children.length-1||s){var i=t.children,o={...t,children:i.slice(n)};if(t.children=i.slice(0,n),r.elements.push(o),s){let e=a.children,r={...a,children:e.slice(0,l)};t.children.push(r),a.children=e.slice(l)}}}}}let c=null;for(let e=a.length-1;e>=0;e--)null==a[e].sectProps?a[e].sectProps=c??t:c=a[e].sectProps;return a}groupByPageBreaks(e){let t,r=[];const a=[r];for(let s of e)r.push(s),(this.options.ignoreLastRenderedPageBreak||s.pageBreak||this.isPageBreakSection(t,s.sectProps))&&a.push(r=[]),t=s.sectProps;return a.filter(e=>e.length>0)}renderWrapper(e){return this.createElement("div",{className:`${this.className}-wrapper`},e)}renderDefaultStyle(){var e=this.className,t=`\n.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \n.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }`;this.options.hideWrapperOnPrint&&(t=`@media not print { ${t} }`);var r=`${t}\n.${e} { color: black; hyphens: auto; text-underline-position: from-font; }\nsection.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\nsection.${e}>article { margin-bottom: auto; z-index: 1; }\nsection.${e}>footer { z-index: 1; }\n.${e} table { border-collapse: collapse; }\n.${e} table td, .${e} table th { vertical-align: top; }\n.${e} p { margin: 0pt; min-height: 1em; }\n.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }\n.${e} a { color: inherit; text-decoration: inherit; }\n.${e} svg { fill: transparent; }\n`;return this.options.renderComments&&(r+=`\n.${e}-comment-ref { cursor: default; }\n.${e}-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }\n.${e}-comment-ref:hover~.${e}-comment-popover { display: block; }\n.${e}-comment-author,.${e}-comment-date { font-size: 0.875rem; color: #888; }\n`),this.createStyleElement(r)}renderNumbering(e,t){var r="",a=[];for(var s of e){var n=`p.${this.numberingClass(s.id,s.level)}`,l="none";if(s.bullet){let e=`--${this.className}-${s.bullet.src}`.toLowerCase();r+=this.styleToString(`${n}:before`,{content:"' '",display:"inline-block",background:`var(${e})`},s.bullet.style),this.tasks.push(this.document.loadNumberingImage(s.bullet.src).then(r=>{var a=`${this.rootSelector} { ${e}: url(${r}) }`;t.appendChild(this.createStyleElement(a))}))}else if(s.levelText){let e=this.numberingCounter(s.id,s.level);const t=e+" "+(s.start-1);s.level>0&&(r+=this.styleToString(`p.${this.numberingClass(s.id,s.level-1)}`,{"counter-set":t})),a.push(t),r+=this.styleToString(`${n}:before`,{content:this.levelTextToContent(s.levelText,s.suff,s.id,this.numFormatToCssValue(s.format)),"counter-increment":e,...s.rStyle})}else l=this.numFormatToCssValue(s.format);r+=this.styleToString(n,{display:"list-item","list-style-position":"inside","list-style-type":l,...s.pStyle})}return a.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":a.join(" ")})),this.createStyleElement(r)}renderStyles(e){var t="";const r=this.styleMap,a=h(e.filter(e=>e.isDefault),e=>e.target);for(const i of e){var s=i.styles;if(i.linked){var n=i.linked&&r[i.linked];n?s=s.concat(n.styles):this.options.debug&&console.warn(`Can't find linked style ${i.linked}`)}for(const e of s){var l=`${i.target??""}.${i.cssName}`;i.target!=e.target&&(l+=` ${e.target}`),a[i.target]==i&&(l=`.${this.className} ${i.target}, `+l),t+=this.styleToString(l,e.values)}}return this.createStyleElement(t)}renderNotes(e,t,r){var a=e.map(e=>t[e]).filter(e=>e);if(a.length>0){var s=this.createElement("ol",null,this.renderElements(a));r.appendChild(s)}}renderElement(e){switch(e.type){case"paragraph":return this.renderParagraph(e);case"bookmarkStart":return this.renderBookmarkStart(e);case"bookmarkEnd":return null;case"run":return this.renderRun(e);case"table":return this.renderTable(e);case"row":return this.renderTableRow(e);case"cell":return this.renderTableCell(e);case"hyperlink":return this.renderHyperlink(e);case"smartTag":return this.renderSmartTag(e);case"drawing":return this.renderDrawing(e);case"image":return this.renderImage(e);case"text":case"text":return this.renderText(e);case"deletedText":return this.renderDeletedText(e);case"tab":return this.renderTab(e);case"symbol":return this.renderSymbol(e);case"break":return this.renderBreak(e);case"footer":return this.renderContainer(e,"footer");case"header":return this.renderContainer(e,"header");case"footnote":case"endnote":return this.renderContainer(e,"li");case"footnoteReference":return this.renderFootnoteReference(e);case"endnoteReference":return this.renderEndnoteReference(e);case"noBreakHyphen":return this.createElement("wbr");case"vmlPicture":return this.renderVmlPicture(e);case"vmlElement":return this.renderVmlElement(e);case"mmlMath":return this.renderContainerNS(e,gt,"math",{xmlns:gt});case"mmlMathParagraph":return this.renderContainer(e,"span");case"mmlFraction":return this.renderContainerNS(e,gt,"mfrac");case"mmlBase":return this.renderContainerNS(e,gt,"mmlMatrixRow"==e.parent.type?"mtd":"mrow");case"mmlNumerator":case"mmlDenominator":case"mmlFunction":case"mmlLimit":case"mmlBox":return this.renderContainerNS(e,gt,"mrow");case"mmlGroupChar":return this.renderMmlGroupChar(e);case"mmlLimitLower":return this.renderContainerNS(e,gt,"munder");case"mmlMatrix":return this.renderContainerNS(e,gt,"mtable");case"mmlMatrixRow":return this.renderContainerNS(e,gt,"mtr");case"mmlRadical":return this.renderMmlRadical(e);case"mmlSuperscript":return this.renderContainerNS(e,gt,"msup");case"mmlSubscript":return this.renderContainerNS(e,gt,"msub");case"mmlDegree":case"mmlSuperArgument":case"mmlSubArgument":return this.renderContainerNS(e,gt,"mn");case"mmlFunctionName":return this.renderContainerNS(e,gt,"ms");case"mmlDelimiter":return this.renderMmlDelimiter(e);case"mmlRun":return this.renderMmlRun(e);case"mmlNary":return this.renderMmlNary(e);case"mmlPreSubSuper":return this.renderMmlPreSubSuper(e);case"mmlBar":return this.renderMmlBar(e);case"mmlEquationArray":return this.renderMllList(e);case"inserted":return this.renderInserted(e);case"deleted":return this.renderDeleted(e);case"commentRangeStart":return this.renderCommentRangeStart(e);case"commentRangeEnd":return this.renderCommentRangeEnd(e);case"commentReference":return this.renderCommentReference(e);case"altChunk":return this.renderAltChunk(e)}return null}renderElements(e,t){if(null==e)return null;var r=e.flatMap(e=>this.renderElement(e)).filter(e=>null!=e);return t&&kt(t,r),r}renderContainer(e,t,r){return this.createElement(t,r,this.renderElements(e.children))}renderContainerNS(e,t,r,a){return this.createElementNS(t,r,a,this.renderElements(e.children))}renderParagraph(e){var t=this.renderContainer(e,"p");const r=this.findStyle(e.styleName);e.tabs??=r?.paragraphProps?.tabs,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderCommonProperties(t.style,e);const a=e.numbering??r?.paragraphProps?.numbering;return a&&t.classList.add(this.numberingClass(a.id,a.level)),t}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize))}renderHyperlink(e){var t=this.renderContainer(e,"a");this.renderStyleValues(e.cssStyle,t);let r="";if(e.id){const t=this.document.documentPart.rels.find(t=>t.id==e.id&&"External"===t.targetMode);r=t?.target??r}return e.anchor&&(r+=`#${e.anchor}`),t.href=r,t}renderSmartTag(e){return this.renderContainer(e,"span")}renderCommentRangeStart(e){if(!this.options.renderComments)return null;const t=new Range;this.commentHighlight?.add(t);const r=this.htmlDocument.createComment(`start of comment #${e.id}`);return this.later(()=>t.setStart(r,0)),this.commentMap[e.id]=t,r}renderCommentRangeEnd(e){if(!this.options.renderComments)return null;const t=this.commentMap[e.id],r=this.htmlDocument.createComment(`end of comment #${e.id}`);return this.later(()=>t?.setEnd(r,0)),r}renderCommentReference(e){if(!this.options.renderComments)return null;var t=this.document.commentsPart?.commentMap[e.id];if(!t)return null;const r=new DocumentFragment,a=this.createElement("span",{className:`${this.className}-comment-ref`},["💬"]),s=this.createElement("div",{className:`${this.className}-comment-popover`});return this.renderCommentContent(t,s),r.appendChild(this.htmlDocument.createComment(`comment #${t.id} by ${t.author} on ${t.date}`)),r.appendChild(a),r.appendChild(s),r}renderAltChunk(e){if(!this.options.renderAltChunks)return null;var t=this.createElement("iframe");return this.tasks.push(this.document.loadAltChunk(e.id,this.currentPart).then(e=>{t.srcdoc=e})),t}renderCommentContent(e,t){t.appendChild(this.createElement("div",{className:`${this.className}-comment-author`},[e.author])),t.appendChild(this.createElement("div",{className:`${this.className}-comment-date`},[new Date(e.date).toLocaleString()])),this.renderElements(e.children,t)}renderDrawing(e){var t=this.renderContainer(e,"div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderStyleValues(e.cssStyle,t),t}renderImage(e){let t=this.createElement("img");return this.renderStyleValues(e.cssStyle,t),this.document&&this.tasks.push(this.document.loadDocumentImage(e.src,this.currentPart).then(e=>{t.src=e})),t}renderText(e){return this.htmlDocument.createTextNode(e.text)}renderDeletedText(e){return this.options.renderEndnotes?this.htmlDocument.createTextNode(e.text):null}renderBreak(e){return"textWrapping"==e.break?this.createElement("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderElements(e.children)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){var t=this.createElement("span");return t.style.fontFamily=e.font,t.innerHTML=`&#x${e.char};`,t}renderFootnoteReference(e){var t=this.createElement("sup");return this.currentFootnoteIds.push(e.id),t.textContent=`${this.currentFootnoteIds.length}`,t}renderEndnoteReference(e){var t=this.createElement("sup");return this.currentEndnoteIds.push(e.id),t.textContent=`${this.currentEndnoteIds.length}`,t}renderTab(e){var t=this.createElement("span");if(t.innerHTML="&emsp;",this.options.experimental){t.className=this.tabStopClass();var r=vt(e,"paragraph")?.tabs;this.currentTabs.push({stops:r,span:t})}return t}renderBookmarkStart(e){return this.createElement("span",{id:e.name})}renderRun(e){if(e.fieldRun)return null;const t=this.createElement("span");if(e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign){const r=this.createElement(e.verticalAlign);this.renderElements(e.children,r),t.appendChild(r)}else this.renderElements(e.children,t);return t}renderTable(e){let t=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){let t=this.createElement("colgroup");for(let r of e){let e=this.createElement("col");r.width&&(e.style.width=r.width),t.appendChild(e)}return t}renderTableRow(e){let t=this.createElement("tr");return this.currentCellPosition.col=0,e.gridBefore&&t.appendChild(this.renderTableCellPlaceholder(e.gridBefore)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),e.gridAfter&&t.appendChild(this.renderTableCellPlaceholder(e.gridAfter)),this.currentCellPosition.row++,t}renderTableCellPlaceholder(e){const t=this.createElement("td",{colSpan:e});return t.style.border="none",t}renderTableCell(e){let t=this.renderContainer(e,"td");const r=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[r]=t,t.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){return this.renderContainer(e,"div")}renderVmlElement(e){var t=this.createSvgElement("svg");t.setAttribute("style",e.cssStyleText);const r=this.renderVmlChildElement(e);return e.imageHref?.id&&this.tasks.push(this.document?.loadDocumentImage(e.imageHref.id,this.currentPart).then(e=>r.setAttribute("href",e))),t.appendChild(r),requestAnimationFrame(()=>{const e=t.firstElementChild.getBBox();t.setAttribute("width",`${Math.ceil(e.x+e.width)}`),t.setAttribute("height",`${Math.ceil(e.y+e.height)}`)}),t}renderVmlChildElement(e){const t=this.createSvgElement(e.tagName);Object.entries(e.attrs).forEach(([e,r])=>t.setAttribute(e,r));for(let r of e.children)"vmlElement"==r.type?t.appendChild(this.renderVmlChildElement(r)):t.appendChild(...f(this.renderElement(r)));return t}renderMmlRadical(e){const t=e.children.find(e=>"mmlBase"==e.type);if(e.props?.hideDegree)return this.createElementNS(gt,"msqrt",null,this.renderElements([t]));const r=e.children.find(e=>"mmlDegree"==e.type);return this.createElementNS(gt,"mroot",null,this.renderElements([t,r]))}renderMmlDelimiter(e){const t=[];return t.push(this.createElementNS(gt,"mo",null,[e.props.beginChar??"("])),t.push(...this.renderElements(e.children)),t.push(this.createElementNS(gt,"mo",null,[e.props.endChar??")"])),this.createElementNS(gt,"mrow",null,t)}renderMmlNary(e){const t=[],r=h(e.children,e=>e.type),a=r.mmlSuperArgument,s=r.mmlSubArgument,n=a?this.createElementNS(gt,"mo",null,f(this.renderElement(a))):null,l=s?this.createElementNS(gt,"mo",null,f(this.renderElement(s))):null,i=this.createElementNS(gt,"mo",null,[e.props?.char??"∫"]);return n||l?t.push(this.createElementNS(gt,"munderover",null,[i,l,n])):n?t.push(this.createElementNS(gt,"mover",null,[i,n])):l?t.push(this.createElementNS(gt,"munder",null,[i,l])):t.push(i),t.push(...this.renderElements(r.mmlBase.children)),this.createElementNS(gt,"mrow",null,t)}renderMmlPreSubSuper(e){const t=[],r=h(e.children,e=>e.type),a=r.mmlSuperArgument,s=r.mmlSubArgument,n=a?this.createElementNS(gt,"mo",null,f(this.renderElement(a))):null,l=s?this.createElementNS(gt,"mo",null,f(this.renderElement(s))):null,i=this.createElementNS(gt,"mo",null);return t.push(this.createElementNS(gt,"msubsup",null,[i,l,n])),t.push(...this.renderElements(r.mmlBase.children)),this.createElementNS(gt,"mrow",null,t)}renderMmlGroupChar(e){const t="bot"===e.props.verticalJustification?"mover":"munder",r=this.renderContainerNS(e,gt,t);return e.props.char&&r.appendChild(this.createElementNS(gt,"mo",null,[e.props.char])),r}renderMmlBar(e){const t=this.renderContainerNS(e,gt,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}renderMmlRun(e){const t=this.createElementNS(gt,"ms",null,this.renderElements(e.children));return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),t}renderMllList(e){const t=this.createElementNS(gt,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t);for(let r of this.renderElements(e.children))t.appendChild(this.createElementNS(gt,"mtr",null,[this.createElementNS(gt,"mtd",null,[r])]));return t}renderStyleValues(e,t){for(let r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){return e&&this.styleMap?.[e]}numberingClass(e,t){return`${this.className}-num-${e}-${t}`}tabStopClass(){return`${this.className}-tab-stop`}styleToString(e,t,r=null){let a=`${e} {\r\n`;for(const e in t)e.startsWith("$")||(a+=`  ${e}: ${t[e]};\r\n`);return r&&(a+=r),a+"}\r\n"}numberingCounter(e,t){return`${this.className}-num-${e}-${t}`}levelTextToContent(e,t,r,a){return`"${e.replace(/%\d*/g,e=>{let t=parseInt(e.substring(1),10)-1;return`"counter(${this.numberingCounter(r,t)}, ${a})"`})}${{tab:"\\9",space:"\\a0"}[t]??""}"`}numFormatToCssValue(e){return{none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e]??e}refreshTabStops(){this.options.experimental&&setTimeout(()=>{const e=pt();for(let t of this.currentTabs)ut(t.span,t.stops,this.defaultTabSize,e)},500)}createElementNS(e,t,r,a){var s=e?this.htmlDocument.createElementNS(e,t):this.htmlDocument.createElement(t);return Object.assign(s,r),a&&kt(s,a),s}createElement(e,t,r){return this.createElementNS(void 0,e,t,r)}createSvgElement(e,t,r){return this.createElementNS(ft,e,t,r)}createStyleElement(e){return this.createElement("style",{innerHTML:e})}createComment(e){return this.htmlDocument.createComment(e)}later(e){this.postRenderTasks.push(e)}};function yt(e){e.innerHTML=""}function kt(e,t){t.forEach(t=>e.appendChild(u(t)?document.createTextNode(t):t))}function vt(e,t){for(var r=e.parent;null!=r&&r.type!=t;)r=r.parent;return r}n(yt,"removeAllElements"),n(kt,"appendChildren"),n(vt,"findParent");var St={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,hideWrapperOnPrint:!1,trimXmlDeclaration:!0,ignoreLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1,renderComments:!1,renderAltChunks:!0};function Pt(e,t){const r={...St,...t};return Ve.load(e,new it(r),r)}async function wt(e,t,r,a){const s={...St,...a},n=new bt(y.document);return await n.render(e,t,r,s)}async function Ct(e,t,r,a){const s=await Pt(e,a);return await wt(s,t,r,a),s}return n(Pt,"parseAsync"),n(wt,"renderDocument"),n(Ct,"renderAsync"),e.defaultOptions=St,e.parseAsync=Pt,e.renderAsync=Ct,e.renderDocument=wt,e}({},JSZip);