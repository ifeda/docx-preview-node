import {JSDOM}from'jsdom';import bt from'jszip';var mt=Object.defineProperty;var l=(n,e)=>mt(n,"name",{value:e,configurable:true});function Re(n){return n?.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}l(Re,"escapeClassName");function A(n){return /^[^"'].*\s.*[^"']$/.test(n)?`'${n}'`:n}l(A,"encloseFontFamily");function N(n){let e=n.lastIndexOf("/")+1,t=e==0?"":n.substring(0,e),r=e==0?n:n.substring(e);return [t,r]}l(N,"splitPath");function H(n,e){try{let t="http://docx/";return new URL(n,t+e).toString().substring(t.length)}catch{return `${e}${n}`}}l(H,"resolvePath");function S(n,e){return n.reduce((t,r)=>(t[e(r)]=r,t),{})}l(S,"keyBy");function Le(n){return new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=()=>t(),r.readAsDataURL(n);})}l(Le,"blobToBase64");function ve(n){return n&&typeof n=="object"&&!Array.isArray(n)}l(ve,"isObject");function Ae(n){return typeof n=="string"||n instanceof String}l(Ae,"isString");function L(n,...e){if(!e.length)return n;let t=e.shift();if(ve(n)&&ve(t))for(let r in t)if(ve(t[r])){let a=n[r]??(n[r]={});L(a,t[r]);}else n[r]=t[r];return L(n,...e)}l(L,"mergeDeep");function w(n){return Array.isArray(n)?n:[n]}l(w,"asArray");function De(n,e,t){return e>n?e:t<n?t:n}l(De,"clamp");var Se={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},C=new JSDOM("<!DOCTYPE html><html><body></body></html>").window,b={Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt",min:.25,max:12},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"}};function D(n,e=b.Dxa){if(n==null||/.+(p[xt]|[%])$/.test(n))return n;var t=parseInt(n)*e.mul;return e.min&&e.max&&(t=De(t,e.min,e.max)),`${t.toFixed(2)}${e.unit}`}l(D,"convertLength");function Be(n,e=false){switch(n){case "1":return  true;case "0":return  false;case "on":return  true;case "off":return  false;case "true":return  true;case "false":return  false;default:return e}}l(Be,"convertBoolean");function I(n,e,t){if(n.namespaceURI!=Se.wordml)return  false;switch(n.localName){case "color":e.color=t.attr(n,"val");break;case "sz":e.fontSize=t.lengthAttr(n,"val",b.FontSize);break;default:return  false}return  true}l(I,"parseCommonProperty");function Oe(n,e){return e.elements(n).map(t=>({id:e.attr(t,"Id"),type:e.attr(t,"Type"),target:e.attr(t,"Target"),targetMode:e.attr(t,"TargetMode")}))}l(Oe,"parseRelationships");function We(n,e=false){e&&(n=n.replace(/<[?].*[?]>/,"")),n=ut(n);let t=new C.DOMParser().parseFromString(n,"application/xml"),r=pt(t);if(r)throw new Error(r);return t}l(We,"parseXmlString");function pt(n){return n.getElementsByTagName("parsererror")[0]?.textContent}l(pt,"hasXmlParserError");function ut(n){return n.charCodeAt(0)===65279?n.substring(1):n}l(ut,"removeUTF8BOM");function Xe(n){return new XMLSerializer().serializeToString(n)}l(Xe,"serializeXmlString");var B=class{static{l(this,"XmlParser");}elements(e,t=null){let r=[];for(let a=0,s=e.childNodes.length;a<s;a++){let i=e.childNodes.item(a);i.nodeType==1&&(t==null||i.localName==t)&&r.push(i);}return r}element(e,t){for(let r=0,a=e.childNodes.length;r<a;r++){let s=e.childNodes.item(r);if(s.nodeType==1&&s.localName==t)return s}return null}elementAttr(e,t,r){var a=this.element(e,t);return a?this.attr(a,r):void 0}attrs(e){return Array.from(e.attributes)}attr(e,t){for(let r=0,a=e.attributes.length;r<a;r++){let s=e.attributes.item(r);if(s.localName==t)return s.value}return null}intAttr(e,t,r=null){var a=this.attr(e,t);return a?parseInt(a):r}hexAttr(e,t,r=null){var a=this.attr(e,t);return a?parseInt(a,16):r}floatAttr(e,t,r=null){var a=this.attr(e,t);return a?parseFloat(a):r}boolAttr(e,t,r=null){return Be(this.attr(e,t),r)}lengthAttr(e,t,r=b.Dxa){return D(this.attr(e,t),r)}},ht=new B,o=ht;var d=class{constructor(e,t){this._package=e;this.path=t;}static{l(this,"Part");}async load(){this.rels=await this._package.loadRelationships(this.path);let e=await this._package.load(this.path),t=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=t),this.parseXml(t.firstElementChild);}save(){this._package.update(this.path,Xe(this._xmlDocument));}parseXml(e){}};var dt={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function Fe(n,e){return e.elements(n).map(t=>gt(t,e))}l(Fe,"parseFonts");function gt(n,e){let t={name:e.attr(n,"name"),embedFontRefs:[]};for(let r of e.elements(n))switch(r.localName){case "family":t.family=e.attr(r,"val");break;case "altName":t.altName=e.attr(r,"val");break;case "embedRegular":case "embedBold":case "embedItalic":case "embedBoldItalic":t.embedFontRefs.push(ft(r,e));break}return t}l(gt,"parseFont");function ft(n,e){return {id:e.attr(n,"id"),key:e.attr(n,"fontKey"),type:dt[n.localName]}}l(ft,"parseEmbedFontRef");var $=class extends d{static{l(this,"FontTablePart");}parseXml(e){this.fonts=Fe(e,this._package.xmlParser);}};var _=class n{constructor(e,t){this._zip=e;this.options=t;this.xmlParser=new B;}static{l(this,"OpenXmlPackage");}get(e){let t=Pt(e);return this._zip.files[t]??this._zip.files[t.replace(/\//g,"\\")]}update(e,t){this._zip.file(e,t);}static async load(e,t){let r=await bt.loadAsync(e);return new n(r,t)}save(e="blob"){return this._zip.generateAsync({type:e})}load(e,t="string"){return this.get(e)?.async(t)??Promise.resolve(null)}async loadRelationships(e=null){let t="_rels/.rels";if(e!=null){let[a,s]=N(e);t=`${a}_rels/${s}.rels`;}let r=await this.load(t);return r?Oe(this.parseXmlDocument(r).firstElementChild,this.xmlParser):null}parseXmlDocument(e){return We(e,this.options.trimXmlDeclaration)}};function Pt(n){return n.startsWith("/")?n.substr(1):n}l(Pt,"normalizePath");var V=class extends d{static{l(this,"DocumentPart");}constructor(e,t,r){super(e,t),this._documentParser=r;}parseXml(e){this.body=this._documentParser.parseDocumentFile(e);}};function z(n,e){return {type:e.attr(n,"val"),color:e.attr(n,"color"),size:e.lengthAttr(n,"sz",b.Border),offset:e.lengthAttr(n,"space",b.Point),frame:e.boolAttr(n,"frame"),shadow:e.boolAttr(n,"shadow")}}l(z,"parseBorder");function He(n,e){var t={};for(let r of e.elements(n))switch(r.localName){case "left":t.left=z(r,e);break;case "top":t.top=z(r,e);break;case "right":t.right=z(r,e);break;case "bottom":t.bottom=z(r,e);break}return t}l(He,"parseBorders");function j(n,e=o){var t={};for(let r of e.elements(n))switch(r.localName){case "pgSz":t.pageSize={width:e.lengthAttr(r,"w"),height:e.lengthAttr(r,"h"),orientation:e.attr(r,"orient")};break;case "type":t.type=e.attr(r,"val");break;case "pgMar":t.pageMargins={left:e.lengthAttr(r,"left"),right:e.lengthAttr(r,"right"),top:e.lengthAttr(r,"top"),bottom:e.lengthAttr(r,"bottom"),header:e.lengthAttr(r,"header"),footer:e.lengthAttr(r,"footer"),gutter:e.lengthAttr(r,"gutter")};break;case "cols":t.columns=kt(r,e);break;case "headerReference":(t.headerRefs??(t.headerRefs=[])).push(Ie(r,e));break;case "footerReference":(t.footerRefs??(t.footerRefs=[])).push(Ie(r,e));break;case "titlePg":t.titlePage=e.boolAttr(r,"val",true);break;case "pgBorders":t.pageBorders=He(r,e);break;case "pgNumType":t.pageNumber=yt(r,e);break}return t}l(j,"parseSectionProperties");function kt(n,e){return {numberOfColumns:e.intAttr(n,"num"),space:e.lengthAttr(n,"space"),separator:e.boolAttr(n,"sep"),equalWidth:e.boolAttr(n,"equalWidth",true),columns:e.elements(n,"col").map(t=>({width:e.lengthAttr(t,"w"),space:e.lengthAttr(t,"space")}))}}l(kt,"parseColumns");function yt(n,e){return {chapSep:e.attr(n,"chapSep"),chapStyle:e.attr(n,"chapStyle"),format:e.attr(n,"fmt"),start:e.intAttr(n,"start")}}l(yt,"parsePageNumber");function Ie(n,e){return {id:e.attr(n,"id"),type:e.attr(n,"type")}}l(Ie,"parseFooterHeaderReference");function $e(n,e){return {before:e.lengthAttr(n,"before"),after:e.lengthAttr(n,"after"),line:e.intAttr(n,"line"),lineRule:e.attr(n,"lineRule")}}l($e,"parseLineSpacing");function M(n,e){let t={};for(let r of e.elements(n))Et(r,t,e);return t}l(M,"parseRunProperties");function Et(n,e,t){return !!I(n,e,t)}l(Et,"parseRunProperty");function U(n,e){let t={};for(let r of e.elements(n))xe(r,t,e);return t}l(U,"parseParagraphProperties");function xe(n,e,t){if(n.namespaceURI!=Se.wordml)return  false;if(I(n,e,t))return  true;switch(n.localName){case "tabs":e.tabs=vt(n,t);break;case "sectPr":e.sectionProps=j(n,t);break;case "numPr":e.numbering=St(n,t);break;case "spacing":return e.lineSpacing=$e(n,t),false;case "textAlignment":return e.textAlignment=t.attr(n,"val"),false;case "keepLines":e.keepLines=t.boolAttr(n,"val",true);break;case "keepNext":e.keepNext=t.boolAttr(n,"val",true);break;case "pageBreakBefore":e.pageBreakBefore=t.boolAttr(n,"val",true);break;case "outlineLvl":e.outlineLevel=t.intAttr(n,"val");break;case "pStyle":e.styleName=t.attr(n,"val");break;case "rPr":e.runProps=M(n,t);break;default:return  false}return  true}l(xe,"parseParagraphProperty");function vt(n,e){return e.elements(n,"tab").map(t=>({position:e.lengthAttr(t,"pos"),leader:e.attr(t,"leader"),style:e.attr(t,"val")}))}l(vt,"parseTabs");function St(n,e){var t={};for(let r of e.elements(n))switch(r.localName){case "numId":t.id=e.attr(r,"val");break;case "ilvl":t.level=e.intAttr(r,"val");break}return t}l(St,"parseNumbering");function _e(n,e){let t={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let r of e.elements(n))switch(r.localName){case "num":t.numberings.push(xt(r,e));break;case "abstractNum":t.abstractNumberings.push(Ct(r,e));break;case "numPicBullet":t.bulletPictures.push(wt(r,e));break}return t}l(_e,"parseNumberingPart");function xt(n,e){let t={id:e.attr(n,"numId"),overrides:[]};for(let r of e.elements(n))switch(r.localName){case "abstractNumId":t.abstractId=e.attr(r,"val");break;case "lvlOverride":t.overrides.push(Nt(r,e));break}return t}l(xt,"parseNumbering");function Ct(n,e){let t={id:e.attr(n,"abstractNumId"),levels:[]};for(let r of e.elements(n))switch(r.localName){case "name":t.name=e.attr(r,"val");break;case "multiLevelType":t.multiLevelType=e.attr(r,"val");break;case "numStyleLink":t.numberingStyleLink=e.attr(r,"val");break;case "styleLink":t.styleLink=e.attr(r,"val");break;case "lvl":t.levels.push(Ve(r,e));break}return t}l(Ct,"parseAbstractNumbering");function Ve(n,e){let t={level:e.intAttr(n,"ilvl")};for(let r of e.elements(n))switch(r.localName){case "start":t.start=e.attr(r,"val");break;case "lvlRestart":t.restart=e.intAttr(r,"val");break;case "numFmt":t.format=e.attr(r,"val");break;case "lvlText":t.text=e.attr(r,"val");break;case "lvlJc":t.justification=e.attr(r,"val");break;case "lvlPicBulletId":t.bulletPictureId=e.attr(r,"val");break;case "pStyle":t.paragraphStyle=e.attr(r,"val");break;case "pPr":t.paragraphProps=U(r,e);break;case "rPr":t.runProps=M(r,e);break}return t}l(Ve,"parseNumberingLevel");function Nt(n,e){let t={level:e.intAttr(n,"ilvl")};for(let r of e.elements(n))switch(r.localName){case "startOverride":t.start=e.intAttr(r,"val");break;case "lvl":t.numberingLevel=Ve(r,e);break}return t}l(Nt,"parseNumberingLevelOverrride");function wt(n,e){var t=e.element(n,"pict"),r=t&&e.element(t,"shape"),a=r&&e.element(r,"imagedata");return a?{id:e.attr(n,"numPicBulletId"),referenceId:e.attr(a,"id"),style:e.attr(r,"style")}:null}l(wt,"parseNumberingBulletPicture");var G=class extends d{static{l(this,"NumberingPart");}constructor(e,t,r){super(e,t),this._documentParser=r;}parseXml(e){Object.assign(this,_e(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e);}};var q=class extends d{static{l(this,"StylesPart");}constructor(e,t,r){super(e,t),this._documentParser=r;}parseXml(e){this.styles=this._documentParser.parseStylesFile(e);}};var v=class{constructor(){this.children=[];this.cssStyle={};}static{l(this,"OpenXmlElementBase");}};var J=class extends v{constructor(){super(...arguments);this.type="header";}static{l(this,"WmlHeader");}},Z=class extends v{constructor(){super(...arguments);this.type="footer";}static{l(this,"WmlFooter");}};var Y=class extends d{static{l(this,"BaseHeaderFooterPart");}constructor(e,t,r){super(e,t),this._documentParser=r;}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e);}},K=class extends Y{static{l(this,"HeaderPart");}createRootElement(){return new J}},Q=class extends Y{static{l(this,"FooterPart");}createRootElement(){return new Z}};function ze(n,e){let t={};for(let r of e.elements(n))switch(r.localName){case "Template":t.template=r.textContent;break;case "Pages":t.pages=O(r.textContent);break;case "Words":t.words=O(r.textContent);break;case "Characters":t.characters=O(r.textContent);break;case "Application":t.application=r.textContent;break;case "Lines":t.lines=O(r.textContent);break;case "Paragraphs":t.paragraphs=O(r.textContent);break;case "Company":t.company=r.textContent;break;case "AppVersion":t.appVersion=r.textContent;break}return t}l(ze,"parseExtendedProps");function O(n){if(!(typeof n>"u"))return parseInt(n)}l(O,"safeParseToInt");var ee=class extends d{static{l(this,"ExtendedPropsPart");}parseXml(e){this.props=ze(e,this._package.xmlParser);}};function je(n,e){let t={};for(let r of e.elements(n))switch(r.localName){case "title":t.title=r.textContent;break;case "description":t.description=r.textContent;break;case "subject":t.subject=r.textContent;break;case "creator":t.creator=r.textContent;break;case "keywords":t.keywords=r.textContent;break;case "language":t.language=r.textContent;break;case "lastModifiedBy":t.lastModifiedBy=r.textContent;break;case "revision":r.textContent&&(t.revision=parseInt(r.textContent));break}return t}l(je,"parseCoreProps");var te=class extends d{static{l(this,"CorePropsPart");}parseXml(e){this.props=je(e,this._package.xmlParser);}};var Ce=class{static{l(this,"DmlTheme");}};function Ge(n,e){var t=new Ce,r=e.element(n,"themeElements");for(let a of e.elements(r))switch(a.localName){case "clrScheme":t.colorScheme=Mt(a,e);break;case "fontScheme":t.fontScheme=Tt(a,e);break}return t}l(Ge,"parseTheme");function Mt(n,e){var t={name:e.attr(n,"name"),colors:{}};for(let s of e.elements(n)){var r=e.element(s,"srgbClr"),a=e.element(s,"sysClr");r?t.colors[s.localName]=e.attr(r,"val"):a&&(t.colors[s.localName]=e.attr(a,"lastClr"));}return t}l(Mt,"parseColorScheme");function Tt(n,e){var t={name:e.attr(n,"name")};for(let r of e.elements(n))switch(r.localName){case "majorFont":t.majorFont=Ue(r,e);break;case "minorFont":t.minorFont=Ue(r,e);break}return t}l(Tt,"parseFontScheme");function Ue(n,e){return {latinTypeface:e.elementAttr(n,"latin","typeface"),eaTypeface:e.elementAttr(n,"ea","typeface"),csTypeface:e.elementAttr(n,"cs","typeface")}}l(Ue,"parseFontInfo");var re=class extends d{static{l(this,"ThemePart");}constructor(e,t){super(e,t);}parseXml(e){this.theme=Ge(e,this._package.xmlParser);}};var ae=class{static{l(this,"WmlBaseNote");}},ne=class extends ae{constructor(){super(...arguments);this.type="footnote";}static{l(this,"WmlFootnote");}},se=class extends ae{constructor(){super(...arguments);this.type="endnote";}static{l(this,"WmlEndnote");}};var oe=class extends d{static{l(this,"BaseNotePart");}constructor(e,t,r){super(e,t),this._documentParser=r;}},le=class extends oe{static{l(this,"FootnotesPart");}constructor(e,t,r){super(e,t,r);}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",ne);}},ie=class extends oe{static{l(this,"EndnotesPart");}constructor(e,t,r){super(e,t,r);}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",se);}};function Je(n,e){var t={};for(let r of e.elements(n))switch(r.localName){case "defaultTabStop":t.defaultTabStop=e.lengthAttr(r,"val");break;case "footnotePr":t.footnoteProps=qe(r,e);break;case "endnotePr":t.endnoteProps=qe(r,e);break;case "autoHyphenation":t.autoHyphenation=e.boolAttr(r,"val");break}return t}l(Je,"parseSettings");function qe(n,e){var t={defaultNoteIds:[]};for(let r of e.elements(n))switch(r.localName){case "numFmt":t.nummeringFormat=e.attr(r,"val");break;case "footnote":case "endnote":t.defaultNoteIds.push(e.attr(r,"id"));break}return t}l(qe,"parseNoteProperties");var me=class extends d{static{l(this,"SettingsPart");}constructor(e,t){super(e,t);}parseXml(e){this.settings=Je(e,this._package.xmlParser);}};function Ze(n,e){return e.elements(n,"property").map(t=>{let r=t.firstChild;return {formatId:e.attr(t,"fmtid"),name:e.attr(t,"name"),type:r.nodeName,value:r.textContent}})}l(Ze,"parseCustomProps");var ce=class extends d{static{l(this,"CustomPropsPart");}parseXml(e){this.props=Ze(e,this._package.xmlParser);}};var pe=class extends d{static{l(this,"CommentsPart");}constructor(e,t,r){super(e,t),this._documentParser=r;}parseXml(e){this.comments=this._documentParser.parseComments(e),this.commentMap=S(this.comments,t=>t.id);}};var ue=class extends d{constructor(t,r){super(t,r);this.comments=[];}static{l(this,"CommentsExtendedPart");}parseXml(t){let r=this._package.xmlParser;for(let a of r.elements(t,"commentEx"))this.comments.push({paraId:r.attr(a,"paraId"),paraIdParent:r.attr(a,"paraIdParent"),done:r.boolAttr(a,"done")});this.commentMap=S(this.comments,a=>a.paraId);}};var Rt=[{type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",target:"word/document.xml"},{type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",target:"docProps/app.xml"},{type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",target:"docProps/core.xml"},{type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",target:"docProps/custom.xml"}],he=class n{constructor(){this.parts=[];this.partsMap={};}static{l(this,"WordDocument");}static async load(e,t,r){var a=new n;return a._options=r,a._parser=t,a._package=await _.load(e,r),a.rels=await a._package.loadRelationships(),await Promise.all(Rt.map(s=>{let i=a.rels.find(m=>m.type===s.type)??s;return a.loadRelationshipPart(i.target,i.type)})),a}save(e="blob"){return this._package.save(e)}async loadRelationshipPart(e,t){if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let r=null;switch(t){case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument":this.documentPart=r=new V(this._package,e,this._parser);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable":this.fontTablePart=r=new $(this._package,e);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering":this.numberingPart=r=new G(this._package,e,this._parser);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":this.stylesPart=r=new q(this._package,e,this._parser);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":this.themePart=r=new re(this._package,e);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes":this.footnotesPart=r=new le(this._package,e,this._parser);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes":this.endnotesPart=r=new ie(this._package,e,this._parser);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer":r=new Q(this._package,e,this._parser);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/header":r=new K(this._package,e,this._parser);break;case "http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties":this.corePropsPart=r=new te(this._package,e);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties":this.extendedPropsPart=r=new ee(this._package,e);break;case "http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties":r=new ce(this._package,e);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings":this.settingsPart=r=new me(this._package,e);break;case "http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments":this.commentsPart=r=new pe(this._package,e,this._parser);break;case "http://schemas.microsoft.com/office/2011/relationships/commentsExtended":this.commentsExtendedPart=r=new ue(this._package,e);break}if(r==null)return Promise.resolve(null);if(this.partsMap[e]=r,this.parts.push(r),await r.load(),r.rels?.length>0){let[a]=N(r.path);await Promise.all(r.rels.map(s=>this.loadRelationshipPart(H(s.target,a),s.type)));}return r}async loadDocumentImage(e,t){let r=await this.loadResource(t??this.documentPart,e,"blob");return this.blobToURL(r)}async loadNumberingImage(e){let t=await this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(t)}async loadFont(e,t){let r=await this.loadResource(this.fontTablePart,e,"uint8array");return r&&this.blobToURL(new Blob([Lt(r,t)]))}async loadAltChunk(e,t){return await this.loadResource(t??this.documentPart,e,"string")}blobToURL(e){return e?this._options.useBase64URL?Le(e):URL.createObjectURL(e):null}findPartByRelId(e,t=null){var r=(t.rels??this.rels).find(s=>s.id==e);let a=t?N(t.path)[0]:"";return r?this.partsMap[H(r.target,a)]:null}getPathById(e,t){let r=e.rels.find(s=>s.id==t),[a]=N(e.path);return r?H(r.target,a):null}loadResource(e,t,r){let a=this.getPathById(e,t);return a?this._package.load(a,r):Promise.resolve(null)}};function Lt(n,e){let r=e.replace(/{|}|-/g,""),a=new Array(16);for(let s=0;s<16;s++)a[16-s-1]=parseInt(r.substr(s*2,2),16);for(let s=0;s<32;s++)n[s]=n[s]^a[s%16];return n}l(Lt,"deobfuscate");function Ye(n,e){return {type:"bookmarkStart",id:e.attr(n,"id"),name:e.attr(n,"name"),colFirst:e.intAttr(n,"colFirst"),colLast:e.intAttr(n,"colLast")}}l(Ye,"parseBookmarkStart");function Ke(n,e){return {type:"bookmarkEnd",id:e.attr(n,"id")}}l(Ke,"parseBookmarkEnd");var Ne=class extends v{constructor(){super(...arguments);this.type="vmlElement";this.attrs={};}static{l(this,"VmlElement");}};function we(n,e){var t=new Ne;switch(n.localName){case "rect":t.tagName="rect",Object.assign(t.attrs,{width:"100%",height:"100%"});break;case "oval":t.tagName="ellipse",Object.assign(t.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case "line":t.tagName="line";break;case "shape":t.tagName="g";break;case "textbox":t.tagName="foreignObject",Object.assign(t.attrs,{width:"100%",height:"100%"});break;default:return null}for(let r of o.attrs(n))switch(r.localName){case "style":t.cssStyleText=r.value;break;case "fillcolor":t.attrs.fill=r.value;break;case "from":let[a,s]=Qe(r.value);Object.assign(t.attrs,{x1:a,y1:s});break;case "to":let[i,m]=Qe(r.value);Object.assign(t.attrs,{x2:i,y2:m});break}for(let r of o.elements(n))switch(r.localName){case "stroke":Object.assign(t.attrs,At(r));break;case "fill":Object.assign(t.attrs,Dt());break;case "imagedata":t.tagName="image",Object.assign(t.attrs,{width:"100%",height:"100%"}),t.imageHref={id:o.attr(r,"id"),title:o.attr(r,"title")};break;case "txbxContent":t.children.push(...e.parseBodyElements(r));break;default:let a=we(r,e);a&&t.children.push(a);break}return t}l(we,"parseVmlElement");function At(n){return {stroke:o.attr(n,"color"),"stroke-width":o.lengthAttr(n,"weight",b.Emu)??"1px"}}l(At,"parseStroke");function Dt(n){return {}}l(Dt,"parseFill");function Qe(n){return n.split(",")}l(Qe,"parsePoint");var de=class extends v{constructor(){super(...arguments);this.type="comment";}static{l(this,"WmlComment");}},ge=class extends v{constructor(t){super();this.id=t;this.type="commentReference";}static{l(this,"WmlCommentReference");}},fe=class extends v{constructor(t){super();this.id=t;this.type="commentRangeStart";}static{l(this,"WmlCommentRangeStart");}},be=class extends v{constructor(t){super();this.id=t;this.type="commentRangeEnd";}static{l(this,"WmlCommentRangeEnd");}};var Pe={shd:"inherit",color:"black",borderColor:"black",highlight:"transparent"},Bt=[],et={oMath:"mmlMath",oMathPara:"mmlMathParagraph",f:"mmlFraction",func:"mmlFunction",fName:"mmlFunctionName",num:"mmlNumerator",den:"mmlDenominator",rad:"mmlRadical",deg:"mmlDegree",e:"mmlBase",sSup:"mmlSuperscript",sSub:"mmlSubscript",sPre:"mmlPreSubSuper",sup:"mmlSuperArgument",sub:"mmlSubArgument",d:"mmlDelimiter",nary:"mmlNary",eqArr:"mmlEquationArray",lim:"mmlLimit",limLow:"mmlLimitLower",m:"mmlMatrix",mr:"mmlMatrixRow",box:"mmlBox",bar:"mmlBar",groupChr:"mmlGroupChar"},ke=class{static{l(this,"DocumentParser");}constructor(e){this.options={ignoreWidth:false,debug:false,...e};}parseNotes(e,t,r){var a=[];for(let s of o.elements(e,t)){let i=new r;i.id=o.attr(s,"id"),i.noteType=o.attr(s,"type"),i.children=this.parseBodyElements(s),a.push(i);}return a}parseComments(e){var t=[];for(let r of o.elements(e,"comment")){let a=new de;a.id=o.attr(r,"id"),a.author=o.attr(r,"author"),a.initials=o.attr(r,"initials"),a.date=o.attr(r,"date"),a.children=this.parseBodyElements(r),t.push(a);}return t}parseDocumentFile(e){var t=o.element(e,"body"),r=o.element(e,"background"),a=o.element(t,"sectPr");return {type:"document",children:this.parseBodyElements(t),props:a?j(a,o):{},cssStyle:r?this.parseBackground(r):{}}}parseBackground(e){var t={},r=f.colorAttr(e,"color");return r&&(t["background-color"]=r),t}parseBodyElements(e){var t=[];for(let r of o.elements(e))switch(r.localName){case "p":t.push(this.parseParagraph(r));break;case "altChunk":t.push(this.parseAltChunk(r));break;case "tbl":t.push(this.parseTable(r));break;case "sdt":t.push(...this.parseSdt(r,a=>this.parseBodyElements(a)));break}return t}parseStylesFile(e){var t=[];return f.foreach(e,r=>{switch(r.localName){case "style":t.push(this.parseStyle(r));break;case "docDefaults":t.push(this.parseDefaultStyles(r));break}}),t}parseDefaultStyles(e){var t={id:null,name:null,target:null,basedOn:null,styles:[]};return f.foreach(e,r=>{switch(r.localName){case "rPrDefault":var a=o.element(r,"rPr");a&&t.styles.push({target:"span",values:this.parseDefaultProperties(a,{})});break;case "pPrDefault":var s=o.element(r,"pPr");s&&t.styles.push({target:"p",values:this.parseDefaultProperties(s,{})});break}}),t}parseStyle(e){var t={id:o.attr(e,"styleId"),isDefault:o.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(o.attr(e,"type")){case "paragraph":t.target="p";break;case "table":t.target="table";break;case "character":t.target="span";break}return f.foreach(e,r=>{switch(r.localName){case "basedOn":t.basedOn=o.attr(r,"val");break;case "name":t.name=o.attr(r,"val");break;case "link":t.linked=o.attr(r,"val");break;case "next":t.next=o.attr(r,"val");break;case "aliases":t.aliases=o.attr(r,"val").split(",");break;case "pPr":t.styles.push({target:"p",values:this.parseDefaultProperties(r,{})}),t.paragraphProps=U(r,o);break;case "rPr":t.styles.push({target:"span",values:this.parseDefaultProperties(r,{})}),t.runProps=M(r,o);break;case "tblPr":case "tcPr":t.styles.push({target:"td",values:this.parseDefaultProperties(r,{})});break;case "tblStylePr":for(let a of this.parseTableStyle(r))t.styles.push(a);break;case "rsid":case "qFormat":case "hidden":case "semiHidden":case "unhideWhenUsed":case "autoRedefine":case "uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${r.localName}`);}}),t}parseTableStyle(e){var t=[],r=o.attr(e,"type"),a="",s="";switch(r){case "firstRow":s=".first-row",a="tr.first-row td";break;case "lastRow":s=".last-row",a="tr.last-row td";break;case "firstCol":s=".first-col",a="td.first-col";break;case "lastCol":s=".last-col",a="td.last-col";break;case "band1Vert":s=":not(.no-vband)",a="td.odd-col";break;case "band2Vert":s=":not(.no-vband)",a="td.even-col";break;case "band1Horz":s=":not(.no-hband)",a="tr.odd-row";break;case "band2Horz":s=":not(.no-hband)",a="tr.even-row";break;default:return []}return f.foreach(e,i=>{switch(i.localName){case "pPr":t.push({target:`${a} p`,mod:s,values:this.parseDefaultProperties(i,{})});break;case "rPr":t.push({target:`${a} span`,mod:s,values:this.parseDefaultProperties(i,{})});break;case "tblPr":case "tcPr":t.push({target:a,mod:s,values:this.parseDefaultProperties(i,{})});break}}),t}parseNumberingFile(e){var t=[],r={},a=[];return f.foreach(e,s=>{switch(s.localName){case "abstractNum":this.parseAbstractNumbering(s,a).forEach(c=>t.push(c));break;case "numPicBullet":a.push(this.parseNumberingPicBullet(s));break;case "num":var i=o.attr(s,"numId"),m=o.elementAttr(s,"abstractNumId","val");r[m]=i;break}}),t.forEach(s=>s.id=r[s.id]),t}parseNumberingPicBullet(e){var t=o.element(e,"pict"),r=t&&o.element(t,"shape"),a=r&&o.element(r,"imagedata");return a?{id:o.intAttr(e,"numPicBulletId"),src:o.attr(a,"id"),style:o.attr(r,"style")}:null}parseAbstractNumbering(e,t){var r=[],a=o.attr(e,"abstractNumId");return f.foreach(e,s=>{switch(s.localName){case "lvl":r.push(this.parseNumberingLevel(a,s,t));break}}),r}parseNumberingLevel(e,t,r){var a={id:e,level:o.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return f.foreach(t,s=>{switch(s.localName){case "start":a.start=o.intAttr(s,"val");break;case "pPr":this.parseDefaultProperties(s,a.pStyle);break;case "rPr":this.parseDefaultProperties(s,a.rStyle);break;case "lvlPicBulletId":var i=o.intAttr(s,"val");a.bullet=r.find(m=>m?.id==i);break;case "lvlText":a.levelText=o.attr(s,"val");break;case "pStyle":a.pStyleName=o.attr(s,"val");break;case "numFmt":a.format=o.attr(s,"val");break;case "suff":a.suff=o.attr(s,"val");break}}),a}parseSdt(e,t){let r=o.element(e,"sdtContent");return r?t(r):[]}parseInserted(e,t){return {type:"inserted",children:t(e)?.children??[]}}parseDeleted(e,t){return {type:"deleted",children:t(e)?.children??[]}}parseAltChunk(e){return {type:"altChunk",children:[],id:o.attr(e,"id")}}parseParagraph(e){var t={type:"paragraph",children:[]};for(let r of o.elements(e))switch(r.localName){case "pPr":this.parseParagraphProperties(r,t);break;case "r":t.children.push(this.parseRun(r,t));break;case "hyperlink":t.children.push(this.parseHyperlink(r,t));break;case "smartTag":t.children.push(this.parseSmartTag(r,t));break;case "bookmarkStart":t.children.push(Ye(r,o));break;case "bookmarkEnd":t.children.push(Ke(r,o));break;case "commentRangeStart":t.children.push(new fe(o.attr(r,"id")));break;case "commentRangeEnd":t.children.push(new be(o.attr(r,"id")));break;case "oMath":case "oMathPara":t.children.push(this.parseMathElement(r));break;case "sdt":t.children.push(...this.parseSdt(r,a=>this.parseParagraph(a).children));break;case "ins":t.children.push(this.parseInserted(r,a=>this.parseParagraph(a)));break;case "del":t.children.push(this.parseDeleted(r,a=>this.parseParagraph(a)));break}return t}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,r=>{if(xe(r,t,o))return  true;switch(r.localName){case "pStyle":t.styleName=o.attr(r,"val");break;case "cnfStyle":t.className=g.classNameOfCnfStyle(r);break;case "framePr":this.parseFrame(r,t);break;case "rPr":break;default:return  false}return  true});}parseFrame(e,t){var r=o.attr(e,"dropCap");r=="drop"&&(t.cssStyle.float="left");}parseHyperlink(e,t){var r={type:"hyperlink",parent:t,children:[]};return r.anchor=o.attr(e,"anchor"),r.id=o.attr(e,"id"),f.foreach(e,a=>{switch(a.localName){case "r":r.children.push(this.parseRun(a,r));break}}),r}parseSmartTag(e,t){var r={type:"smartTag",parent:t,children:[]},a=o.attr(e,"uri"),s=o.attr(e,"element");return a&&(r.uri=a),s&&(r.element=s),f.foreach(e,i=>{switch(i.localName){case "r":r.children.push(this.parseRun(i,r));break}}),r}parseRun(e,t){var r={type:"run",parent:t,children:[]};return f.foreach(e,a=>{switch(a=this.checkAlternateContent(a),a.localName){case "t":r.children.push({type:"text",text:a.textContent});break;case "delText":r.children.push({type:"deletedText",text:a.textContent});break;case "commentReference":r.children.push(new ge(o.attr(a,"id")));break;case "fldSimple":r.children.push({type:"simpleField",instruction:o.attr(a,"instr"),lock:o.boolAttr(a,"lock",false),dirty:o.boolAttr(a,"dirty",false)});break;case "instrText":r.fieldRun=true,r.children.push({type:"instruction",text:a.textContent});break;case "fldChar":r.fieldRun=true,r.children.push({type:"complexField",charType:o.attr(a,"fldCharType"),lock:o.boolAttr(a,"lock",false),dirty:o.boolAttr(a,"dirty",false)});break;case "noBreakHyphen":r.children.push({type:"noBreakHyphen"});break;case "br":r.children.push({type:"break",break:o.attr(a,"type")||"textWrapping"});break;case "lastRenderedPageBreak":r.children.push({type:"break",break:"lastRenderedPageBreak"});break;case "sym":r.children.push({type:"symbol",font:A(o.attr(a,"font")),char:o.attr(a,"char")});break;case "tab":r.children.push({type:"tab"});break;case "footnoteReference":r.children.push({type:"footnoteReference",id:o.attr(a,"id")});break;case "endnoteReference":r.children.push({type:"endnoteReference",id:o.attr(a,"id")});break;case "drawing":let s=this.parseDrawing(a);s&&(r.children=[s]);break;case "pict":r.children.push(this.parseVmlPicture(a));break;case "rPr":this.parseRunProperties(a,r);break}}),r}parseMathElement(e){let t=`${e.localName}Pr`,r={type:et[e.localName],children:[]};for(let s of o.elements(e))if(et[s.localName])r.children.push(this.parseMathElement(s));else if(s.localName=="r"){var a=this.parseRun(s);a.type="mmlRun",r.children.push(a);}else s.localName==t&&(r.props=this.parseMathProperies(s));return r}parseMathProperies(e){let t={};for(let r of o.elements(e))switch(r.localName){case "chr":t.char=o.attr(r,"val");break;case "vertJc":t.verticalJustification=o.attr(r,"val");break;case "pos":t.position=o.attr(r,"val");break;case "degHide":t.hideDegree=o.boolAttr(r,"val");break;case "begChr":t.beginChar=o.attr(r,"val");break;case "endChr":t.endChar=o.attr(r,"val");break}return t}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,r=>{switch(r.localName){case "rStyle":t.styleName=o.attr(r,"val");break;case "vertAlign":t.verticalAlign=g.valueOfVertAlign(r,true);break;default:return  false}return  true});}parseVmlPicture(e){let t={type:"vmlPicture",children:[]};for(let r of o.elements(e)){let a=we(r,this);a&&t.children.push(a);}return t}checkAlternateContent(e){if(e.localName!="AlternateContent")return e;var t=o.element(e,"Choice");if(t){var r=o.attr(t,"Requires"),a=e.lookupNamespaceURI(r);if(Bt.includes(a))return t.firstElementChild}return o.element(e,"Fallback")?.firstElementChild}parseDrawing(e){for(var t of o.elements(e))switch(t.localName){case "inline":case "anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){var t={type:"drawing",children:[],cssStyle:{}},r=e.localName=="anchor";let a=null,s=o.boolAttr(e,"simplePos");o.boolAttr(e,"behindDoc");let m={relative:"page",align:"left",offset:"0"},c={relative:"page",align:"top",offset:"0"};for(var h of o.elements(e))switch(h.localName){case "simplePos":s&&(m.offset=o.lengthAttr(h,"x",b.Emu),c.offset=o.lengthAttr(h,"y",b.Emu));break;case "extent":t.cssStyle.width=o.lengthAttr(h,"cx",b.Emu),t.cssStyle.height=o.lengthAttr(h,"cy",b.Emu);break;case "positionH":case "positionV":if(!s){let y=h.localName=="positionH"?m:c;var P=o.element(h,"align"),u=o.element(h,"posOffset");y.relative=o.attr(h,"relativeFrom")??y.relative,P&&(y.align=P.textContent),u&&(y.offset=f.sizeValue(u,b.Emu));}break;case "wrapTopAndBottom":a="wrapTopAndBottom";break;case "wrapNone":a="wrapNone";break;case "graphic":var k=this.parseGraphic(h);k&&t.children.push(k);break}return a=="wrapTopAndBottom"?(t.cssStyle.display="block",m.align&&(t.cssStyle["text-align"]=m.align,t.cssStyle.width="100%")):a=="wrapNone"?(t.cssStyle.display="block",t.cssStyle.position="relative",t.cssStyle.width="0px",t.cssStyle.height="0px",m.offset&&(t.cssStyle.left=m.offset),c.offset&&(t.cssStyle.top=c.offset)):r&&(m.align=="left"||m.align=="right")&&(t.cssStyle.float=m.align),t}parseGraphic(e){var t=o.element(e,"graphicData");for(let r of o.elements(t))switch(r.localName){case "pic":return this.parsePicture(r)}return null}parsePicture(e){var t={type:"image",src:"",cssStyle:{}},r=o.element(e,"blipFill"),a=o.element(r,"blip");t.src=o.attr(a,"embed");var s=o.element(e,"spPr"),i=o.element(s,"xfrm");t.cssStyle.position="relative";for(var m of o.elements(i))switch(m.localName){case "ext":t.cssStyle.width=o.lengthAttr(m,"cx",b.Emu),t.cssStyle.height=o.lengthAttr(m,"cy",b.Emu);break;case "off":t.cssStyle.left=o.lengthAttr(m,"x",b.Emu),t.cssStyle.top=o.lengthAttr(m,"y",b.Emu);break}return t}parseTable(e){var t={type:"table",children:[]};return f.foreach(e,r=>{switch(r.localName){case "tr":t.children.push(this.parseTableRow(r));break;case "tblGrid":t.columns=this.parseTableColumns(r);break;case "tblPr":this.parseTableProperties(r,t);break}}),t}parseTableColumns(e){var t=[];return f.foreach(e,r=>{switch(r.localName){case "gridCol":t.push({width:o.lengthAttr(r,"w")});break}}),t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,r=>{switch(r.localName){case "tblStyle":t.styleName=o.attr(r,"val");break;case "tblLook":t.className=g.classNameOftblLook(r);break;case "tblpPr":this.parseTablePosition(r,t);break;case "tblStyleColBandSize":t.colBandSize=o.intAttr(r,"val");break;case "tblStyleRowBandSize":t.rowBandSize=o.intAttr(r,"val");break;case "hidden":t.cssStyle.display="none";break;default:return  false}return  true}),t.cssStyle["text-align"]){case "center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case "right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto";break}}parseTablePosition(e,t){var r=o.lengthAttr(e,"topFromText"),a=o.lengthAttr(e,"bottomFromText"),s=o.lengthAttr(e,"rightFromText"),i=o.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=g.addSize(t.cssStyle["margin-bottom"],a),t.cssStyle["margin-left"]=g.addSize(t.cssStyle["margin-left"],i),t.cssStyle["margin-right"]=g.addSize(t.cssStyle["margin-right"],s),t.cssStyle["margin-top"]=g.addSize(t.cssStyle["margin-top"],r);}parseTableRow(e){var t={type:"row",children:[]};return f.foreach(e,r=>{switch(r.localName){case "tc":t.children.push(this.parseTableCell(r));break;case "trPr":this.parseTableRowProperties(r,t);break}}),t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,r=>{switch(r.localName){case "cnfStyle":t.className=g.classNameOfCnfStyle(r);break;case "tblHeader":t.isHeader=o.boolAttr(r,"val");break;case "gridBefore":t.gridBefore=o.intAttr(r,"val");break;case "gridAfter":t.gridAfter=o.intAttr(r,"val");break;default:return  false}return  true});}parseTableCell(e){var t={type:"cell",children:[]};return f.foreach(e,r=>{switch(r.localName){case "tbl":t.children.push(this.parseTable(r));break;case "p":t.children.push(this.parseParagraph(r));break;case "tcPr":this.parseTableCellProperties(r,t);break}}),t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,r=>{switch(r.localName){case "gridSpan":t.span=o.intAttr(r,"val",null);break;case "vMerge":t.verticalMerge=o.attr(r,"val")??"continue";break;case "cnfStyle":t.className=g.classNameOfCnfStyle(r);break;default:return  false}return  true}),this.parseTableCellVerticalText(e,t);}parseTableCellVerticalText(e,t){let r={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};f.foreach(e,a=>{if(a.localName==="textDirection"){let s=o.attr(a,"val"),i=r[s]||{writingMode:"horizontal-tb"};t.cssStyle["writing-mode"]=i.writingMode,t.cssStyle.transform=i.transform;}});}parseDefaultProperties(e,t=null,r=null,a=null){return t=t||{},f.foreach(e,s=>{if(!a?.(s))switch(s.localName){case "jc":t["text-align"]=g.valueOfJc(s);break;case "textAlignment":t["vertical-align"]=g.valueOfTextAlignment(s);break;case "color":t.color=f.colorAttr(s,"val",null,Pe.color);break;case "sz":t["font-size"]=t["min-height"]=o.lengthAttr(s,"val",b.FontSize);break;case "shd":t["background-color"]=f.colorAttr(s,"fill",null,Pe.shd);break;case "highlight":t["background-color"]=f.colorAttr(s,"val",null,Pe.highlight);break;case "vertAlign":break;case "position":t.verticalAlign=o.lengthAttr(s,"val",b.FontSize);break;case "tcW":if(this.options.ignoreWidth)break;case "tblW":t.width=g.valueOfSize(s,"w");break;case "trHeight":this.parseTrHeight(s,t);break;case "strike":t["text-decoration"]=o.boolAttr(s,"val",true)?"line-through":"none";break;case "b":t["font-weight"]=o.boolAttr(s,"val",true)?"bold":"normal";break;case "i":t["font-style"]=o.boolAttr(s,"val",true)?"italic":"normal";break;case "caps":t["text-transform"]=o.boolAttr(s,"val",true)?"uppercase":"none";break;case "smallCaps":t["font-variant"]=o.boolAttr(s,"val",true)?"small-caps":"none";break;case "u":this.parseUnderline(s,t);break;case "ind":case "tblInd":this.parseIndentation(s,t);break;case "rFonts":this.parseFont(s,t);break;case "tblBorders":this.parseBorderProperties(s,r||t);break;case "tblCellSpacing":t["border-spacing"]=g.valueOfMargin(s),t["border-collapse"]="separate";break;case "pBdr":this.parseBorderProperties(s,t);break;case "bdr":t.border=g.valueOfBorder(s);break;case "tcBorders":this.parseBorderProperties(s,t);break;case "vanish":o.boolAttr(s,"val",true)&&(t.display="none");break;case "kern":break;case "noWrap":break;case "tblCellMar":case "tcMar":this.parseMarginProperties(s,r||t);break;case "tblLayout":t["table-layout"]=g.valueOfTblLayout(s);break;case "vAlign":t["vertical-align"]=g.valueOfTextAlignment(s);break;case "spacing":e.localName=="pPr"&&this.parseSpacing(s,t);break;case "wordWrap":o.boolAttr(s,"val")&&(t["overflow-wrap"]="break-word");break;case "suppressAutoHyphens":t.hyphens=o.boolAttr(s,"val",true)?"none":"auto";break;case "lang":t.$lang=o.attr(s,"val");break;case "bCs":case "iCs":case "szCs":case "tabs":case "outlineLvl":case "contextualSpacing":case "tblStyleColBandSize":case "tblStyleRowBandSize":case "webHidden":case "pageBreakBefore":case "suppressLineNumbers":case "keepLines":case "keepNext":case "widowControl":case "bidi":case "rtl":case "noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${e.localName}.${s.localName}`);break}}),t}parseUnderline(e,t){var r=o.attr(e,"val");if(r!=null){switch(r){case "dash":case "dashDotDotHeavy":case "dashDotHeavy":case "dashedHeavy":case "dashLong":case "dashLongHeavy":case "dotDash":case "dotDotDash":t["text-decoration"]="underline dashed";break;case "dotted":case "dottedHeavy":t["text-decoration"]="underline dotted";break;case "double":t["text-decoration"]="underline double";break;case "single":case "thick":t["text-decoration"]="underline";break;case "wave":case "wavyDouble":case "wavyHeavy":t["text-decoration"]="underline wavy";break;case "words":t["text-decoration"]="underline";break;case "none":t["text-decoration"]="none";break}var a=f.colorAttr(e,"color");a&&(t["text-decoration-color"]=a);}}parseFont(e,t){var r=o.attr(e,"ascii"),a=g.themeValue(e,"asciiTheme"),s=o.attr(e,"eastAsia"),i=[r,a,s].filter(m=>m).map(m=>A(m));i.length>0&&(t["font-family"]=[...new Set(i)].join(", "));}parseIndentation(e,t){var r=o.lengthAttr(e,"firstLine"),a=o.lengthAttr(e,"hanging"),s=o.lengthAttr(e,"left"),i=o.lengthAttr(e,"start"),m=o.lengthAttr(e,"right"),c=o.lengthAttr(e,"end");r&&(t["text-indent"]=r),a&&(t["text-indent"]=`-${a}`),(s||i)&&(t["margin-left"]=s||i),(m||c)&&(t["margin-right"]=m||c);}parseSpacing(e,t){var r=o.lengthAttr(e,"before"),a=o.lengthAttr(e,"after"),s=o.intAttr(e,"line",null),i=o.attr(e,"lineRule");if(r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),s!==null)switch(i){case "auto":t["line-height"]=`${(s/240).toFixed(2)}`;break;case "atLeast":t["line-height"]=`calc(100% + ${s/20}pt)`;break;default:t["line-height"]=t["min-height"]=`${s/20}pt`;break}}parseMarginProperties(e,t){f.foreach(e,r=>{switch(r.localName){case "left":t["padding-left"]=g.valueOfMargin(r);break;case "right":t["padding-right"]=g.valueOfMargin(r);break;case "top":t["padding-top"]=g.valueOfMargin(r);break;case "bottom":t["padding-bottom"]=g.valueOfMargin(r);break}});}parseTrHeight(e,t){switch(o.attr(e,"hRule")){case "exact":t.height=o.lengthAttr(e,"val");break;case "atLeast":default:t.height=o.lengthAttr(e,"val");break}}parseBorderProperties(e,t){f.foreach(e,r=>{switch(r.localName){case "start":case "left":t["border-left"]=g.valueOfBorder(r);break;case "end":case "right":t["border-right"]=g.valueOfBorder(r);break;case "top":t["border-top"]=g.valueOfBorder(r);break;case "bottom":t["border-bottom"]=g.valueOfBorder(r);break}});}},Ot=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"],f=class{static{l(this,"xmlUtil");}static foreach(e,t){for(var r=0;r<e.childNodes.length;r++){let a=e.childNodes[r];a.nodeType==C.Node.ELEMENT_NODE&&t(a);}}static colorAttr(e,t,r=null,a="black"){var s=o.attr(e,t);if(s)return s=="auto"?a:Ot.includes(s)?s:`#${s}`;var i=o.attr(e,"themeColor");return i?`var(--docx-${i}-color)`:r}static sizeValue(e,t=b.Dxa){return D(e.textContent,t)}},g=class n{static{l(this,"values");}static themeValue(e,t){var r=o.attr(e,t);return r?`var(--docx-${r}-font)`:null}static valueOfSize(e,t){var r=b.Dxa;switch(o.attr(e,"type")){case "dxa":break;case "pct":r=b.Percent;break;case "auto":return "auto"}return o.lengthAttr(e,t,r)}static valueOfMargin(e){return o.lengthAttr(e,"w")}static valueOfBorder(e){var t=n.parseBorderType(o.attr(e,"val"));if(t=="none")return "none";var r=f.colorAttr(e,"color"),a=o.lengthAttr(e,"sz",b.Border);return `${a} ${t} ${r=="auto"?Pe.borderColor:r}`}static parseBorderType(e){switch(e){case "single":return "solid";case "dashDotStroked":return "solid";case "dashed":return "dashed";case "dashSmallGap":return "dashed";case "dotDash":return "dotted";case "dotDotDash":return "dotted";case "dotted":return "dotted";case "double":return "double";case "doubleWave":return "double";case "inset":return "inset";case "nil":return "none";case "none":return "none";case "outset":return "outset";case "thick":return "solid";case "thickThinLargeGap":return "solid";case "thickThinMediumGap":return "solid";case "thickThinSmallGap":return "solid";case "thinThickLargeGap":return "solid";case "thinThickMediumGap":return "solid";case "thinThickSmallGap":return "solid";case "thinThickThinLargeGap":return "solid";case "thinThickThinMediumGap":return "solid";case "thinThickThinSmallGap":return "solid";case "threeDEmboss":return "solid";case "threeDEngrave":return "solid";case "triple":return "double";case "wave":return "solid"}return "solid"}static valueOfTblLayout(e){var t=o.attr(e,"val");return t=="fixed"?"fixed":"auto"}static classNameOfCnfStyle(e){let t=o.attr(e,"val");return ["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((a,s)=>t[s]=="1").join(" ")}static valueOfJc(e){var t=o.attr(e,"val");switch(t){case "start":case "left":return "left";case "center":return "center";case "end":case "right":return "right";case "both":return "justify"}return t}static valueOfVertAlign(e,t=false){var r=o.attr(e,"val");switch(r){case "subscript":return "sub";case "superscript":return t?"sup":"super"}return t?null:r}static valueOfTextAlignment(e){var t=o.attr(e,"val");switch(t){case "auto":case "baseline":return "baseline";case "top":return "top";case "center":return "middle";case "bottom":return "bottom"}return t}static addSize(e,t){return e==null?t:t==null?e:`calc(${e} + ${t})`}static classNameOftblLook(e){let t=o.hexAttr(e,"val",0),r="";return (o.boolAttr(e,"firstRow")||t&32)&&(r+=" first-row"),(o.boolAttr(e,"lastRow")||t&64)&&(r+=" last-row"),(o.boolAttr(e,"firstColumn")||t&128)&&(r+=" first-col"),(o.boolAttr(e,"lastColumn")||t&256)&&(r+=" last-col"),(o.boolAttr(e,"noHBand")||t&512)&&(r+=" no-hband"),(o.boolAttr(e,"noVBand")||t&1024)&&(r+=" no-vband"),r.trim()}};var tt={pos:0,leader:"none",style:"left"},Wt=50;function at(n=C.document.body){let e=document.createElement("div");e.style.width="100pt",n.appendChild(e);let t=100/e.offsetWidth;return n.removeChild(e),t}l(at,"computePixelToPoint");function nt(n,e,t,r=72/96){let a=n.closest("p"),s=n.getBoundingClientRect(),i=a.getBoundingClientRect(),m=getComputedStyle(a),c=e?.length>0?e.map(E=>({pos:rt(E.position),leader:E.leader,style:E.style})).sort((E,X)=>E.pos-X.pos):[tt],h=c[c.length-1],P=i.width*r,u=rt(t),k=h.pos+u;if(k<P)for(;k<P&&c.length<Wt;k+=u)c.push({...tt,pos:k});let y=parseFloat(m.marginLeft),W=i.left+y,R=(s.left-W)*r,x=c.find(E=>E.style!="clear"&&E.pos>R);if(x==null)return;let Ee=1;if(x.style=="right"||x.style=="center"){let E=Array.from(a.querySelectorAll(`.${n.className}`)),X=E.indexOf(n)+1,F=document.createRange();F.setStart(n,1),X<E.length?F.setEndBefore(E[X]):F.setEndAfter(a);let lt=x.style=="center"?.5:1,Te=F.getBoundingClientRect(),it=Te.left+lt*Te.width-(i.left-y);Ee=x.pos-it*r;}else Ee=x.pos-R;switch(n.innerHTML="&nbsp;",n.style.textDecoration="inherit",n.style.wordSpacing=`${Ee.toFixed(0)}pt`,x.leader){case "dot":case "middleDot":n.style.textDecoration="underline",n.style.textDecorationStyle="dotted";break;case "hyphen":case "heavy":case "underscore":n.style.textDecoration="underline";break}}l(nt,"updateTabStop");function rt(n){return parseFloat(n)}l(rt,"lengthToPoint");var p={svg:"http://www.w3.org/2000/svg",mathML:"http://www.w3.org/1998/Math/MathML"},ye=class{constructor(e){this.htmlDocument=e;this.className="docx";this.styleMap={};this.currentPart=null;this.tableVerticalMerges=[];this.currentVerticalMerge=null;this.tableCellPositions=[];this.currentCellPosition=null;this.footnoteMap={};this.endnoteMap={};this.currentEndnoteIds=[];this.usedHederFooterParts=[];this.currentTabs=[];this.commentMap={};this.tasks=[];this.postRenderTasks=[];}static{l(this,"HtmlRenderer");}async render(e,t,r=null,a){this.document=e,this.options=a,this.className=a.className,this.rootSelector=a.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],this.options.renderComments&&globalThis.Highlight&&(this.commentHighlight=new Highlight),r=r||t,st(r),st(t),r.appendChild(this.createComment("docxjs library predefined styles")),r.appendChild(this.renderDefaultStyle()),e.themePart&&(r.appendChild(this.createComment("docxjs document theme values")),this.renderTheme(e.themePart,r)),e.stylesPart!=null&&(this.styleMap=this.processStyles(e.stylesPart.styles),r.appendChild(this.createComment("docxjs document styles")),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.prodessNumberings(e.numberingPart.domNumberings),r.appendChild(this.createComment("docxjs document numbering styles")),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),e.footnotesPart&&(this.footnoteMap=S(e.footnotesPart.notes,i=>i.id)),e.endnotesPart&&(this.endnoteMap=S(e.endnotesPart.notes,i=>i.id)),e.settingsPart&&(this.defaultTabSize=e.settingsPart.settings?.defaultTabStop),!a.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r);var s=this.renderSections(e.documentPart.body);this.options.inWrapper?t.appendChild(this.renderWrapper(s)):Me(t,s),this.commentHighlight&&a.renderComments&&CSS.highlights.set(`${this.className}-comments`,this.commentHighlight),this.postRenderTasks.forEach(i=>i()),await Promise.allSettled(this.tasks),this.refreshTabStops();}renderTheme(e,t){let r={},a=e.theme?.fontScheme;a&&(a.majorFont&&(r["--docx-majorHAnsi-font"]=a.majorFont.latinTypeface),a.minorFont&&(r["--docx-minorHAnsi-font"]=a.minorFont.latinTypeface));let s=e.theme?.colorScheme;if(s)for(let[m,c]of Object.entries(s.colors))r[`--docx-${m}-color`]=`#${c}`;let i=this.styleToString(`.${this.className}`,r);t.appendChild(this.createStyleElement(i));}renderFontTable(e,t){for(let r of e.fonts)for(let a of r.embedFontRefs)this.tasks.push(this.document.loadFont(a.id,a.key).then(s=>{let i={"font-family":A(r.name),src:`url(${s})`};(a.type=="bold"||a.type=="boldItalic")&&(i["font-weight"]="bold"),(a.type=="italic"||a.type=="boldItalic")&&(i["font-style"]="italic");let m=this.styleToString("@font-face",i);t.appendChild(this.createComment(`docxjs ${r.name} font`)),t.appendChild(this.createStyleElement(m));}));}processStyleName(e){return e?`${this.className}_${Re(e)}`:this.className}processStyles(e){let t=S(e.filter(a=>a.id!=null),a=>a.id);for(let a of e.filter(s=>s.basedOn)){var r=t[a.basedOn];if(r){a.paragraphProps=L(a.paragraphProps,r.paragraphProps),a.runProps=L(a.runProps,r.runProps);for(let s of r.styles){let i=a.styles.find(m=>m.target==s.target);i?this.copyStyleProperties(s.values,i.values):a.styles.push({...s,values:{...s.values}});}}else this.options.debug&&console.warn(`Can't find base style ${a.basedOn}`);}for(let a of e)a.cssName=this.processStyleName(a.id);return t}prodessNumberings(e){for(let t of e.filter(r=>r.pStyleName)){let r=this.findStyle(t.pStyleName);r?.paragraphProps?.numbering&&(r.paragraphProps.numbering.level=t.level);}}processElement(e){if(e.children)for(var t of e.children)t.parent=e,t.type=="table"?this.processTable(t):this.processElement(t);}processTable(e){for(var t of e.children)for(var r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r);}copyStyleProperties(e,t,r=null){if(!e)return t;t==null&&(t={}),r==null&&(r=Object.getOwnPropertyNames(e));for(var a of r)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a]);return t}createPageElement(e,t){var r=this.createElement("section",{className:e});return t&&(t.pageMargins&&(r.style.paddingLeft=t.pageMargins.left,r.style.paddingRight=t.pageMargins.right,r.style.paddingTop=t.pageMargins.top,r.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(r.style.width=t.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=t.pageSize.height))),r}createSectionContent(e){var t=this.createElement("article");return e.columns&&e.columns.numberOfColumns&&(t.style.columnCount=`${e.columns.numberOfColumns}`,t.style.columnGap=e.columns.space,e.columns.separator&&(t.style.columnRule="1px solid black")),t}renderSections(e){let t=[];this.processElement(e);let r=this.splitBySection(e.children,e.props),a=this.groupByPageBreaks(r),s=null;for(let m=0,c=a.length;m<c;m++){this.currentFootnoteIds=[];let P=a[m][0].sectProps,u=this.createPageElement(this.className,P);this.renderStyleValues(e.cssStyle,u),this.options.renderHeaders&&this.renderHeaderFooter(P.headerRefs,P,t.length,s!=P,u);for(let k of a[m]){var i=this.createSectionContent(k.sectProps);this.renderElements(k.elements,i),u.appendChild(i),P=k.sectProps;}this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,u),this.options.renderEndnotes&&m==c-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,u),this.options.renderFooters&&this.renderHeaderFooter(P.footerRefs,P,t.length,s!=P,u),t.push(u),s=P;}return t}renderHeaderFooter(e,t,r,a,s){if(e){var i=(t.titlePage&&a?e.find(c=>c.type=="first"):null)??(r%2==1?e.find(c=>c.type=="even"):null)??e.find(c=>c.type=="default"),m=i&&this.document.findPartByRelId(i.id,this.document.documentPart);if(m){this.currentPart=m,this.usedHederFooterParts.includes(m.path)||(this.processElement(m.rootElement),this.usedHederFooterParts.push(m.path));let[c]=this.renderElements([m.rootElement],s);t?.pageMargins&&(m.rootElement.type==="header"?(c.style.marginTop=`calc(${t.pageMargins.header} - ${t.pageMargins.top})`,c.style.minHeight=`calc(${t.pageMargins.top} - ${t.pageMargins.header})`):m.rootElement.type==="footer"&&(c.style.marginBottom=`calc(${t.pageMargins.footer} - ${t.pageMargins.bottom})`,c.style.minHeight=`calc(${t.pageMargins.bottom} - ${t.pageMargins.footer})`)),this.currentPart=null;}}}isPageBreakElement(e){return e.type!="break"?false:e.break=="lastRenderedPageBreak"?!this.options.ignoreLastRenderedPageBreak:e.break=="page"}isPageBreakSection(e,t){return !e||!t?false:e.pageSize?.orientation!=t.pageSize?.orientation||e.pageSize?.width!=t.pageSize?.width||e.pageSize?.height!=t.pageSize?.height}splitBySection(e,t){var r={sectProps:null,elements:[],pageBreak:false},a=[r];for(let u of e)if(u.type=="paragraph"&&this.findStyle(u.styleName)?.paragraphProps?.pageBreakBefore&&(r.sectProps=s,r.pageBreak=true,r={sectProps:null,elements:[],pageBreak:false},a.push(r)),r.elements.push(u),u.type=="paragraph"){let k=u;var s=k.sectionProps,i=-1,m=-1;if(this.options.breakPages&&k.children&&(i=k.children.findIndex(y=>(m=y.children?.findIndex(this.isPageBreakElement.bind(this))??-1,m!=-1))),(s||i!=-1)&&(r.sectProps=s,r.pageBreak=i!=-1,r={sectProps:null,elements:[],pageBreak:false},a.push(r)),i!=-1){let y=k.children[i],W=m<y.children.length-1;if(i<k.children.length-1||W){var c=u.children,h={...u,children:c.slice(i)};if(u.children=c.slice(0,i),r.elements.push(h),W){let R=y.children,x={...y,children:R.slice(0,m)};u.children.push(x),y.children=R.slice(m);}}}}let P=null;for(let u=a.length-1;u>=0;u--)a[u].sectProps==null?a[u].sectProps=P??t:P=a[u].sectProps;return a}groupByPageBreaks(e){let t=[],r,a=[t];for(let s of e)t.push(s),(this.options.ignoreLastRenderedPageBreak||s.pageBreak||this.isPageBreakSection(r,s.sectProps))&&a.push(t=[]),r=s.sectProps;return a.filter(s=>s.length>0)}renderWrapper(e){return this.createElement("div",{className:`${this.className}-wrapper`},e)}renderDefaultStyle(){var e=this.className,t=`
.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } 
.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }`;this.options.hideWrapperOnPrint&&(t=`@media not print { ${t} }`);var r=`${t}
.${e} { color: black; hyphens: auto; text-underline-position: from-font; }
section.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }
section.${e}>article { margin-bottom: auto; z-index: 1; }
section.${e}>footer { z-index: 1; }
.${e} table { border-collapse: collapse; }
.${e} table td, .${e} table th { vertical-align: top; }
.${e} p { margin: 0pt; min-height: 1em; }
.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }
.${e} a { color: inherit; text-decoration: inherit; }
.${e} svg { fill: transparent; }
`;return this.options.renderComments&&(r+=`
.${e}-comment-ref { cursor: default; }
.${e}-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }
.${e}-comment-ref:hover~.${e}-comment-popover { display: block; }
.${e}-comment-author,.${e}-comment-date { font-size: 0.875rem; color: #888; }
`),this.createStyleElement(r)}renderNumbering(e,t){var r="",a=[];for(var s of e){var i=`p.${this.numberingClass(s.id,s.level)}`,m="none";if(s.bullet){let c=`--${this.className}-${s.bullet.src}`.toLowerCase();r+=this.styleToString(`${i}:before`,{content:"' '",display:"inline-block",background:`var(${c})`},s.bullet.style),this.tasks.push(this.document.loadNumberingImage(s.bullet.src).then(h=>{var P=`${this.rootSelector} { ${c}: url(${h}) }`;t.appendChild(this.createStyleElement(P));}));}else if(s.levelText){let c=this.numberingCounter(s.id,s.level),h=c+" "+(s.start-1);s.level>0&&(r+=this.styleToString(`p.${this.numberingClass(s.id,s.level-1)}`,{"counter-set":h})),a.push(h),r+=this.styleToString(`${i}:before`,{content:this.levelTextToContent(s.levelText,s.suff,s.id,this.numFormatToCssValue(s.format)),"counter-increment":c,...s.rStyle});}else m=this.numFormatToCssValue(s.format);r+=this.styleToString(i,{display:"list-item","list-style-position":"inside","list-style-type":m,...s.pStyle});}return a.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":a.join(" ")})),this.createStyleElement(r)}renderStyles(e){var t="";let r=this.styleMap,a=S(e.filter(c=>c.isDefault),c=>c.target);for(let c of e){var s=c.styles;if(c.linked){var i=c.linked&&r[c.linked];i?s=s.concat(i.styles):this.options.debug&&console.warn(`Can't find linked style ${c.linked}`);}for(let h of s){var m=`${c.target??""}.${c.cssName}`;c.target!=h.target&&(m+=` ${h.target}`),a[c.target]==c&&(m=`.${this.className} ${c.target}, `+m),t+=this.styleToString(m,h.values);}}return this.createStyleElement(t)}renderNotes(e,t,r){var a=e.map(i=>t[i]).filter(i=>i);if(a.length>0){var s=this.createElement("ol",null,this.renderElements(a));r.appendChild(s);}}renderElement(e){switch(e.type){case "paragraph":return this.renderParagraph(e);case "bookmarkStart":return this.renderBookmarkStart(e);case "bookmarkEnd":return null;case "run":return this.renderRun(e);case "table":return this.renderTable(e);case "row":return this.renderTableRow(e);case "cell":return this.renderTableCell(e);case "hyperlink":return this.renderHyperlink(e);case "smartTag":return this.renderSmartTag(e);case "drawing":return this.renderDrawing(e);case "image":return this.renderImage(e);case "text":return this.renderText(e);case "text":return this.renderText(e);case "deletedText":return this.renderDeletedText(e);case "tab":return this.renderTab(e);case "symbol":return this.renderSymbol(e);case "break":return this.renderBreak(e);case "footer":return this.renderContainer(e,"footer");case "header":return this.renderContainer(e,"header");case "footnote":case "endnote":return this.renderContainer(e,"li");case "footnoteReference":return this.renderFootnoteReference(e);case "endnoteReference":return this.renderEndnoteReference(e);case "noBreakHyphen":return this.createElement("wbr");case "vmlPicture":return this.renderVmlPicture(e);case "vmlElement":return this.renderVmlElement(e);case "mmlMath":return this.renderContainerNS(e,p.mathML,"math",{xmlns:p.mathML});case "mmlMathParagraph":return this.renderContainer(e,"span");case "mmlFraction":return this.renderContainerNS(e,p.mathML,"mfrac");case "mmlBase":return this.renderContainerNS(e,p.mathML,e.parent.type=="mmlMatrixRow"?"mtd":"mrow");case "mmlNumerator":case "mmlDenominator":case "mmlFunction":case "mmlLimit":case "mmlBox":return this.renderContainerNS(e,p.mathML,"mrow");case "mmlGroupChar":return this.renderMmlGroupChar(e);case "mmlLimitLower":return this.renderContainerNS(e,p.mathML,"munder");case "mmlMatrix":return this.renderContainerNS(e,p.mathML,"mtable");case "mmlMatrixRow":return this.renderContainerNS(e,p.mathML,"mtr");case "mmlRadical":return this.renderMmlRadical(e);case "mmlSuperscript":return this.renderContainerNS(e,p.mathML,"msup");case "mmlSubscript":return this.renderContainerNS(e,p.mathML,"msub");case "mmlDegree":case "mmlSuperArgument":case "mmlSubArgument":return this.renderContainerNS(e,p.mathML,"mn");case "mmlFunctionName":return this.renderContainerNS(e,p.mathML,"ms");case "mmlDelimiter":return this.renderMmlDelimiter(e);case "mmlRun":return this.renderMmlRun(e);case "mmlNary":return this.renderMmlNary(e);case "mmlPreSubSuper":return this.renderMmlPreSubSuper(e);case "mmlBar":return this.renderMmlBar(e);case "mmlEquationArray":return this.renderMllList(e);case "inserted":return this.renderInserted(e);case "deleted":return this.renderDeleted(e);case "commentRangeStart":return this.renderCommentRangeStart(e);case "commentRangeEnd":return this.renderCommentRangeEnd(e);case "commentReference":return this.renderCommentReference(e);case "altChunk":return this.renderAltChunk(e)}return null}renderElements(e,t){if(e==null)return null;var r=e.flatMap(a=>this.renderElement(a)).filter(a=>a!=null);return t&&Me(t,r),r}renderContainer(e,t,r){return this.createElement(t,r,this.renderElements(e.children))}renderContainerNS(e,t,r,a){return this.createElementNS(t,r,a,this.renderElements(e.children))}renderParagraph(e){var t=this.renderContainer(e,"p");let r=this.findStyle(e.styleName);e.tabs??=r?.paragraphProps?.tabs,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderCommonProperties(t.style,e);let a=e.numbering??r?.paragraphProps?.numbering;return a&&t.classList.add(this.numberingClass(a.id,a.level)),t}renderRunProperties(e,t){this.renderCommonProperties(e,t);}renderCommonProperties(e,t){t!=null&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize));}renderHyperlink(e){var t=this.renderContainer(e,"a");this.renderStyleValues(e.cssStyle,t);let r="";return e.id&&(r=this.document.documentPart.rels.find(s=>s.id==e.id&&s.targetMode==="External")?.target??r),e.anchor&&(r+=`#${e.anchor}`),t.href=r,t}renderSmartTag(e){return this.renderContainer(e,"span")}renderCommentRangeStart(e){if(!this.options.renderComments)return null;let t=new Range;this.commentHighlight?.add(t);let r=this.htmlDocument.createComment(`start of comment #${e.id}`);return this.later(()=>t.setStart(r,0)),this.commentMap[e.id]=t,r}renderCommentRangeEnd(e){if(!this.options.renderComments)return null;let t=this.commentMap[e.id],r=this.htmlDocument.createComment(`end of comment #${e.id}`);return this.later(()=>t?.setEnd(r,0)),r}renderCommentReference(e){if(!this.options.renderComments)return null;var t=this.document.commentsPart?.commentMap[e.id];if(!t)return null;let r=new DocumentFragment,a=this.createElement("span",{className:`${this.className}-comment-ref`},["\u{1F4AC}"]),s=this.createElement("div",{className:`${this.className}-comment-popover`});return this.renderCommentContent(t,s),r.appendChild(this.htmlDocument.createComment(`comment #${t.id} by ${t.author} on ${t.date}`)),r.appendChild(a),r.appendChild(s),r}renderAltChunk(e){if(!this.options.renderAltChunks)return null;var t=this.createElement("iframe");return this.tasks.push(this.document.loadAltChunk(e.id,this.currentPart).then(r=>{t.srcdoc=r;})),t}renderCommentContent(e,t){t.appendChild(this.createElement("div",{className:`${this.className}-comment-author`},[e.author])),t.appendChild(this.createElement("div",{className:`${this.className}-comment-date`},[new Date(e.date).toLocaleString()])),this.renderElements(e.children,t);}renderDrawing(e){var t=this.renderContainer(e,"div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderStyleValues(e.cssStyle,t),t}renderImage(e){let t=this.createElement("img");return this.renderStyleValues(e.cssStyle,t),this.document&&this.tasks.push(this.document.loadDocumentImage(e.src,this.currentPart).then(r=>{t.src=r;})),t}renderText(e){return this.htmlDocument.createTextNode(e.text)}renderDeletedText(e){return this.options.renderEndnotes?this.htmlDocument.createTextNode(e.text):null}renderBreak(e){return e.break=="textWrapping"?this.createElement("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderElements(e.children)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){var t=this.createElement("span");return t.style.fontFamily=e.font,t.innerHTML=`&#x${e.char};`,t}renderFootnoteReference(e){var t=this.createElement("sup");return this.currentFootnoteIds.push(e.id),t.textContent=`${this.currentFootnoteIds.length}`,t}renderEndnoteReference(e){var t=this.createElement("sup");return this.currentEndnoteIds.push(e.id),t.textContent=`${this.currentEndnoteIds.length}`,t}renderTab(e){var t=this.createElement("span");if(t.innerHTML="&emsp;",this.options.experimental){t.className=this.tabStopClass();var r=Xt(e,"paragraph")?.tabs;this.currentTabs.push({stops:r,span:t});}return t}renderBookmarkStart(e){return this.createElement("span",{id:e.name})}renderRun(e){if(e.fieldRun)return null;let t=this.createElement("span");if(e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign){let r=this.createElement(e.verticalAlign);this.renderElements(e.children,r),t.appendChild(r);}else this.renderElements(e.children,t);return t}renderTable(e){let t=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){let t=this.createElement("colgroup");for(let r of e){let a=this.createElement("col");r.width&&(a.style.width=r.width),t.appendChild(a);}return t}renderTableRow(e){let t=this.createElement("tr");return this.currentCellPosition.col=0,e.gridBefore&&t.appendChild(this.renderTableCellPlaceholder(e.gridBefore)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),e.gridAfter&&t.appendChild(this.renderTableCellPlaceholder(e.gridAfter)),this.currentCellPosition.row++,t}renderTableCellPlaceholder(e){let t=this.createElement("td",{colSpan:e});return t.style.border="none",t}renderTableCell(e){let t=this.renderContainer(e,"td"),r=this.currentCellPosition.col;return e.verticalMerge?e.verticalMerge=="restart"?(this.currentVerticalMerge[r]=t,t.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){return this.renderContainer(e,"div")}renderVmlElement(e){var t=this.createSvgElement("svg");t.setAttribute("style",e.cssStyleText);let r=this.renderVmlChildElement(e);return e.imageHref?.id&&this.tasks.push(this.document?.loadDocumentImage(e.imageHref.id,this.currentPart).then(a=>r.setAttribute("href",a))),t.appendChild(r),requestAnimationFrame(()=>{let a=t.firstElementChild.getBBox();t.setAttribute("width",`${Math.ceil(a.x+a.width)}`),t.setAttribute("height",`${Math.ceil(a.y+a.height)}`);}),t}renderVmlChildElement(e){let t=this.createSvgElement(e.tagName);Object.entries(e.attrs).forEach(([r,a])=>t.setAttribute(r,a));for(let r of e.children)r.type=="vmlElement"?t.appendChild(this.renderVmlChildElement(r)):t.appendChild(...w(this.renderElement(r)));return t}renderMmlRadical(e){let t=e.children.find(a=>a.type=="mmlBase");if(e.props?.hideDegree)return this.createElementNS(p.mathML,"msqrt",null,this.renderElements([t]));let r=e.children.find(a=>a.type=="mmlDegree");return this.createElementNS(p.mathML,"mroot",null,this.renderElements([t,r]))}renderMmlDelimiter(e){let t=[];return t.push(this.createElementNS(p.mathML,"mo",null,[e.props.beginChar??"("])),t.push(...this.renderElements(e.children)),t.push(this.createElementNS(p.mathML,"mo",null,[e.props.endChar??")"])),this.createElementNS(p.mathML,"mrow",null,t)}renderMmlNary(e){let t=[],r=S(e.children,h=>h.type),a=r.mmlSuperArgument,s=r.mmlSubArgument,i=a?this.createElementNS(p.mathML,"mo",null,w(this.renderElement(a))):null,m=s?this.createElementNS(p.mathML,"mo",null,w(this.renderElement(s))):null,c=this.createElementNS(p.mathML,"mo",null,[e.props?.char??"\u222B"]);return i||m?t.push(this.createElementNS(p.mathML,"munderover",null,[c,m,i])):i?t.push(this.createElementNS(p.mathML,"mover",null,[c,i])):m?t.push(this.createElementNS(p.mathML,"munder",null,[c,m])):t.push(c),t.push(...this.renderElements(r.mmlBase.children)),this.createElementNS(p.mathML,"mrow",null,t)}renderMmlPreSubSuper(e){let t=[],r=S(e.children,h=>h.type),a=r.mmlSuperArgument,s=r.mmlSubArgument,i=a?this.createElementNS(p.mathML,"mo",null,w(this.renderElement(a))):null,m=s?this.createElementNS(p.mathML,"mo",null,w(this.renderElement(s))):null,c=this.createElementNS(p.mathML,"mo",null);return t.push(this.createElementNS(p.mathML,"msubsup",null,[c,m,i])),t.push(...this.renderElements(r.mmlBase.children)),this.createElementNS(p.mathML,"mrow",null,t)}renderMmlGroupChar(e){let t=e.props.verticalJustification==="bot"?"mover":"munder",r=this.renderContainerNS(e,p.mathML,t);return e.props.char&&r.appendChild(this.createElementNS(p.mathML,"mo",null,[e.props.char])),r}renderMmlBar(e){let t=this.renderContainerNS(e,p.mathML,"mrow");switch(e.props.position){case "top":t.style.textDecoration="overline";break;case "bottom":t.style.textDecoration="underline";break}return t}renderMmlRun(e){let t=this.createElementNS(p.mathML,"ms",null,this.renderElements(e.children));return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),t}renderMllList(e){let t=this.createElementNS(p.mathML,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t);for(let r of this.renderElements(e.children))t.appendChild(this.createElementNS(p.mathML,"mtr",null,[this.createElementNS(p.mathML,"mtd",null,[r])]));return t}renderStyleValues(e,t){for(let r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r];}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName));}findStyle(e){return e&&this.styleMap?.[e]}numberingClass(e,t){return `${this.className}-num-${e}-${t}`}tabStopClass(){return `${this.className}-tab-stop`}styleToString(e,t,r=null){let a=`${e} {\r
`;for(let s in t)s.startsWith("$")||(a+=`  ${s}: ${t[s]};\r
`);return r&&(a+=r),a+`}\r
`}numberingCounter(e,t){return `${this.className}-num-${e}-${t}`}levelTextToContent(e,t,r,a){let s={tab:"\\9",space:"\\a0"};var i=e.replace(/%\d*/g,m=>{let c=parseInt(m.substring(1),10)-1;return `"counter(${this.numberingCounter(r,c)}, ${a})"`});return `"${i}${s[t]??""}"`}numFormatToCssValue(e){var t={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"};return t[e]??e}refreshTabStops(){this.options.experimental&&setTimeout(()=>{let e=at();for(let t of this.currentTabs)nt(t.span,t.stops,this.defaultTabSize,e);},500);}createElementNS(e,t,r,a){var s=e?this.htmlDocument.createElementNS(e,t):this.htmlDocument.createElement(t);return Object.assign(s,r),a&&Me(s,a),s}createElement(e,t,r){return this.createElementNS(void 0,e,t,r)}createSvgElement(e,t,r){return this.createElementNS(p.svg,e,t,r)}createStyleElement(e){return this.createElement("style",{innerHTML:e})}createComment(e){return this.htmlDocument.createComment(e)}later(e){this.postRenderTasks.push(e);}};function st(n){n.innerHTML="";}l(st,"removeAllElements");function Me(n,e){e.forEach(t=>n.appendChild(Ae(t)?document.createTextNode(t):t));}l(Me,"appendChildren");function Xt(n,e){for(var t=n.parent;t!=null&&t.type!=e;)t=t.parent;return t}l(Xt,"findParent");var ot={ignoreHeight:false,ignoreWidth:false,ignoreFonts:false,breakPages:true,debug:false,experimental:false,className:"docx",inWrapper:true,hideWrapperOnPrint:false,trimXmlDeclaration:true,ignoreLastRenderedPageBreak:true,renderHeaders:true,renderFooters:true,renderFootnotes:true,renderEndnotes:true,useBase64URL:false,renderChanges:false,renderComments:false,renderAltChunks:true};function Ft(n,e){let t={...ot,...e};return he.load(n,new ke(t),t)}l(Ft,"parseAsync");async function Ht(n,e,t,r){let a={...ot,...r};return await new ye(C.document).render(n,e,t,a)}l(Ht,"renderDocument");async function eo(n,e,t,r){let a=await Ft(n,r);return await Ht(a,e,t,r),a}l(eo,"renderAsync");export{ot as defaultOptions,Ft as parseAsync,eo as renderAsync,Ht as renderDocument};